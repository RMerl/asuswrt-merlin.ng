--- a/source3/librpc/gen_ndr/srv_atsvc.c
+++ b/source3/librpc/gen_ndr/srv_atsvc.c
@@ -51,7 +51,7 @@ static bool api_atsvc_JobAdd(struct pipe
 
 	r->out.result = _atsvc_JobAdd(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -124,7 +124,7 @@ static bool api_atsvc_JobDel(struct pipe
 
 	r->out.result = _atsvc_JobDel(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -206,7 +206,7 @@ static bool api_atsvc_JobEnum(struct pip
 
 	r->out.result = _atsvc_JobEnum(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -286,7 +286,7 @@ static bool api_atsvc_JobGetInfo(struct
 
 	r->out.result = _atsvc_JobGetInfo(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
--- a/source3/librpc/gen_ndr/srv_audiosrv.c
+++ b/source3/librpc/gen_ndr/srv_audiosrv.c
@@ -44,7 +44,7 @@ static bool api_audiosrv_CreatezoneFacto
 
 	_audiosrv_CreatezoneFactoriesList(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -117,7 +117,7 @@ static bool api_audiosrv_CreateGfxFactor
 
 	_audiosrv_CreateGfxFactoriesList(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -190,7 +190,7 @@ static bool api_audiosrv_CreateGfxList(s
 
 	_audiosrv_CreateGfxList(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -263,7 +263,7 @@ static bool api_audiosrv_RemoveGfx(struc
 
 	_audiosrv_RemoveGfx(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -336,7 +336,7 @@ static bool api_audiosrv_AddGfx(struct p
 
 	_audiosrv_AddGfx(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -409,7 +409,7 @@ static bool api_audiosrv_ModifyGfx(struc
 
 	_audiosrv_ModifyGfx(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -482,7 +482,7 @@ static bool api_audiosrv_OpenGfx(struct
 
 	_audiosrv_OpenGfx(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -555,7 +555,7 @@ static bool api_audiosrv_Logon(struct pi
 
 	_audiosrv_Logon(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -628,7 +628,7 @@ static bool api_audiosrv_Logoff(struct p
 
 	_audiosrv_Logoff(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -701,7 +701,7 @@ static bool api_audiosrv_RegisterSession
 
 	_audiosrv_RegisterSessionNotificationEvent(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -774,7 +774,7 @@ static bool api_audiosrv_UnregisterSessi
 
 	_audiosrv_UnregisterSessionNotificationEvent(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -847,7 +847,7 @@ static bool api_audiosrv_SessionConnectS
 
 	_audiosrv_SessionConnectState(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -920,7 +920,7 @@ static bool api_audiosrv_DriverOpenDrvRe
 
 	_audiosrv_DriverOpenDrvRegKey(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -993,7 +993,7 @@ static bool api_audiosrv_AdvisePreferred
 
 	_audiosrv_AdvisePreferredDeviceChange(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1066,7 +1066,7 @@ static bool api_audiosrv_GetPnpInfo(stru
 
 	_audiosrv_GetPnpInfo(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
--- a/source3/librpc/gen_ndr/srv_backupkey.c
+++ b/source3/librpc/gen_ndr/srv_backupkey.c
@@ -57,7 +57,7 @@ static bool api_bkrp_BackupKey(struct pi
 
 	r->out.result = _bkrp_BackupKey(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
--- a/source3/librpc/gen_ndr/srv_browser.c
+++ b/source3/librpc/gen_ndr/srv_browser.c
@@ -44,7 +44,7 @@ static bool api_BrowserrServerEnum(struc
 
 	_BrowserrServerEnum(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -117,7 +117,7 @@ static bool api_BrowserrDebugCall(struct
 
 	_BrowserrDebugCall(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -198,7 +198,7 @@ static bool api_BrowserrQueryOtherDomain
 
 	r->out.result = _BrowserrQueryOtherDomains(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -271,7 +271,7 @@ static bool api_BrowserrResetNetlogonSta
 
 	_BrowserrResetNetlogonState(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -344,7 +344,7 @@ static bool api_BrowserrDebugTrace(struc
 
 	_BrowserrDebugTrace(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -417,7 +417,7 @@ static bool api_BrowserrQueryStatistics(
 
 	_BrowserrQueryStatistics(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -490,7 +490,7 @@ static bool api_BrowserResetStatistics(s
 
 	_BrowserResetStatistics(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -563,7 +563,7 @@ static bool api_NetrBrowserStatisticsCle
 
 	_NetrBrowserStatisticsClear(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -636,7 +636,7 @@ static bool api_NetrBrowserStatisticsGet
 
 	_NetrBrowserStatisticsGet(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -709,7 +709,7 @@ static bool api_BrowserrSetNetlogonState
 
 	_BrowserrSetNetlogonState(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -782,7 +782,7 @@ static bool api_BrowserrQueryEmulatedDom
 
 	_BrowserrQueryEmulatedDomains(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -855,7 +855,7 @@ static bool api_BrowserrServerEnumEx(str
 
 	_BrowserrServerEnumEx(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
--- a/source3/librpc/gen_ndr/srv_dbgidl.c
+++ b/source3/librpc/gen_ndr/srv_dbgidl.c
@@ -44,7 +44,7 @@ static bool api_dummy_dbgidl(struct pipe
 
 	_dummy_dbgidl(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
--- a/source3/librpc/gen_ndr/srv_dcom.c
+++ b/source3/librpc/gen_ndr/srv_dcom.c
@@ -44,7 +44,7 @@ static bool api_UseProtSeq(struct pipes_
 
 	_UseProtSeq(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -117,7 +117,7 @@ static bool api_GetCustomProtseqInfo(str
 
 	_GetCustomProtseqInfo(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -190,7 +190,7 @@ static bool api_UpdateResolverBindings(s
 
 	_UpdateResolverBindings(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -300,7 +300,7 @@ static bool api_QueryInterface(struct pi
 
 	r->out.result = _QueryInterface(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -380,7 +380,7 @@ static bool api_AddRef(struct pipes_stru
 
 	r->out.result = _AddRef(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -460,7 +460,7 @@ static bool api_Release(struct pipes_str
 
 	r->out.result = _Release(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -570,7 +570,7 @@ static bool api_CreateInstance(struct pi
 
 	r->out.result = _CreateInstance(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -650,7 +650,7 @@ static bool api_RemoteCreateInstance(str
 
 	r->out.result = _RemoteCreateInstance(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -730,7 +730,7 @@ static bool api_LockServer(struct pipes_
 
 	r->out.result = _LockServer(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -810,7 +810,7 @@ static bool api_RemoteLockServer(struct
 
 	r->out.result = _RemoteLockServer(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -921,7 +921,7 @@ static bool api_RemQueryInterface(struct
 
 	r->out.result = _RemQueryInterface(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1007,7 +1007,7 @@ static bool api_RemAddRef(struct pipes_s
 
 	r->out.result = _RemAddRef(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1087,7 +1087,7 @@ static bool api_RemRelease(struct pipes_
 
 	r->out.result = _RemRelease(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1197,7 +1197,7 @@ static bool api_GetClassObject(struct pi
 
 	_GetClassObject(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1299,7 +1299,7 @@ static bool api_ISCMLocalActivator_Creat
 
 	r->out.result = _ISCMLocalActivator_CreateInstance(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1394,7 +1394,7 @@ static bool api_IMachineLocalActivator_f
 
 	r->out.result = _IMachineLocalActivator_foo(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1489,7 +1489,7 @@ static bool api_ILocalObjectExporter_Foo
 
 	r->out.result = _ILocalObjectExporter_Foo(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1603,7 +1603,7 @@ static bool api_ISystemActivatorRemoteCr
 
 	r->out.result = _ISystemActivatorRemoteCreateInstance(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1717,7 +1717,7 @@ static bool api_RemQueryInterface2(struc
 
 	r->out.result = _RemQueryInterface2(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1825,7 +1825,7 @@ static bool api_GetTypeInfoCount(struct
 
 	r->out.result = _GetTypeInfoCount(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1911,7 +1911,7 @@ static bool api_GetTypeInfo(struct pipes
 
 	r->out.result = _GetTypeInfo(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1997,7 +1997,7 @@ static bool api_GetIDsOfNames(struct pip
 
 	r->out.result = _GetIDsOfNames(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2096,7 +2096,7 @@ static bool api_Invoke(struct pipes_stru
 
 	r->out.result = _Invoke(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2201,7 +2201,7 @@ static bool api_MarshalInterface(struct
 
 	r->out.result = _MarshalInterface(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2281,7 +2281,7 @@ static bool api_UnMarshalInterface(struc
 
 	r->out.result = _UnMarshalInterface(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2384,7 +2384,7 @@ static bool api_MakeCoffee(struct pipes_
 
 	r->out.result = _MakeCoffee(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2498,7 +2498,7 @@ static bool api_Read(struct pipes_struct
 
 	r->out.result = _Read(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2584,7 +2584,7 @@ static bool api_Write(struct pipes_struc
 
 	r->out.result = _Write(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
--- a/source3/librpc/gen_ndr/srv_dfsblobs.c
+++ b/source3/librpc/gen_ndr/srv_dfsblobs.c
@@ -51,7 +51,7 @@ static bool api_dfs_GetDFSReferral(struc
 
 	_dfs_GetDFSReferral(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
--- a/source3/librpc/gen_ndr/srv_dfs.c
+++ b/source3/librpc/gen_ndr/srv_dfs.c
@@ -51,7 +51,7 @@ static bool api_dfs_GetManagerVersion(st
 
 	_dfs_GetManagerVersion(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -124,7 +124,7 @@ static bool api_dfs_Add(struct pipes_str
 
 	r->out.result = _dfs_Add(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -197,7 +197,7 @@ static bool api_dfs_Remove(struct pipes_
 
 	r->out.result = _dfs_Remove(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -270,7 +270,7 @@ static bool api_dfs_SetInfo(struct pipes
 
 	r->out.result = _dfs_SetInfo(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -350,7 +350,7 @@ static bool api_dfs_GetInfo(struct pipes
 
 	r->out.result = _dfs_GetInfo(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -426,7 +426,7 @@ static bool api_dfs_Enum(struct pipes_st
 	r->out.total = r->in.total;
 	r->out.result = _dfs_Enum(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -499,7 +499,7 @@ static bool api_dfs_Rename(struct pipes_
 
 	r->out.result = _dfs_Rename(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -572,7 +572,7 @@ static bool api_dfs_Move(struct pipes_st
 
 	r->out.result = _dfs_Move(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -645,7 +645,7 @@ static bool api_dfs_ManagerGetConfigInfo
 
 	r->out.result = _dfs_ManagerGetConfigInfo(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -718,7 +718,7 @@ static bool api_dfs_ManagerSendSiteInfo(
 
 	r->out.result = _dfs_ManagerSendSiteInfo(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -793,7 +793,7 @@ static bool api_dfs_AddFtRoot(struct pip
 	r->out.unknown2 = r->in.unknown2;
 	r->out.result = _dfs_AddFtRoot(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -868,7 +868,7 @@ static bool api_dfs_RemoveFtRoot(struct
 	r->out.unknown = r->in.unknown;
 	r->out.result = _dfs_RemoveFtRoot(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -941,7 +941,7 @@ static bool api_dfs_AddStdRoot(struct pi
 
 	r->out.result = _dfs_AddStdRoot(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1014,7 +1014,7 @@ static bool api_dfs_RemoveStdRoot(struct
 
 	r->out.result = _dfs_RemoveStdRoot(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1087,7 +1087,7 @@ static bool api_dfs_ManagerInitialize(st
 
 	r->out.result = _dfs_ManagerInitialize(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1160,7 +1160,7 @@ static bool api_dfs_AddStdRootForced(str
 
 	r->out.result = _dfs_AddStdRootForced(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1237,7 +1237,7 @@ static bool api_dfs_GetDcAddress(struct
 	r->out.ttl = r->in.ttl;
 	r->out.result = _dfs_GetDcAddress(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1310,7 +1310,7 @@ static bool api_dfs_SetDcAddress(struct
 
 	r->out.result = _dfs_SetDcAddress(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1383,7 +1383,7 @@ static bool api_dfs_FlushFtTable(struct
 
 	r->out.result = _dfs_FlushFtTable(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1456,7 +1456,7 @@ static bool api_dfs_Add2(struct pipes_st
 
 	r->out.result = _dfs_Add2(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1529,7 +1529,7 @@ static bool api_dfs_Remove2(struct pipes
 
 	r->out.result = _dfs_Remove2(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1605,7 +1605,7 @@ static bool api_dfs_EnumEx(struct pipes_
 	r->out.total = r->in.total;
 	r->out.result = _dfs_EnumEx(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1678,7 +1678,7 @@ static bool api_dfs_SetInfo2(struct pipe
 
 	r->out.result = _dfs_SetInfo2(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
--- a/source3/librpc/gen_ndr/srv_dns.c
+++ b/source3/librpc/gen_ndr/srv_dns.c
@@ -44,7 +44,7 @@ static bool api_decode_dns_name_packet(s
 
 	_decode_dns_name_packet(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
--- a/source3/librpc/gen_ndr/srv_dnsp.c
+++ b/source3/librpc/gen_ndr/srv_dnsp.c
@@ -44,7 +44,7 @@ static bool api_decode_DnssrvRpcRecord(s
 
 	_decode_DnssrvRpcRecord(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
--- a/source3/librpc/gen_ndr/srv_dnsserver.c
+++ b/source3/librpc/gen_ndr/srv_dnsserver.c
@@ -44,7 +44,7 @@ static bool api_dnsserver_foo(struct pip
 
 	_dnsserver_foo(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
--- a/source3/librpc/gen_ndr/srv_drsblobs.c
+++ b/source3/librpc/gen_ndr/srv_drsblobs.c
@@ -44,7 +44,7 @@ static bool api_decode_replPropertyMetaD
 
 	_decode_replPropertyMetaData(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -117,7 +117,7 @@ static bool api_decode_replUpToDateVecto
 
 	_decode_replUpToDateVector(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -190,7 +190,7 @@ static bool api_decode_repsFromTo(struct
 
 	_decode_repsFromTo(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -263,7 +263,7 @@ static bool api_decode_partialAttributeS
 
 	_decode_partialAttributeSet(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -336,7 +336,7 @@ static bool api_decode_prefixMap(struct
 
 	_decode_prefixMap(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -409,7 +409,7 @@ static bool api_decode_ldapControlDirSyn
 
 	_decode_ldapControlDirSync(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -482,7 +482,7 @@ static bool api_decode_supplementalCrede
 
 	_decode_supplementalCredentials(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -555,7 +555,7 @@ static bool api_decode_Packages(struct p
 
 	_decode_Packages(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -628,7 +628,7 @@ static bool api_decode_PrimaryKerberos(s
 
 	_decode_PrimaryKerberos(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -701,7 +701,7 @@ static bool api_decode_PrimaryCLEARTEXT(
 
 	_decode_PrimaryCLEARTEXT(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -774,7 +774,7 @@ static bool api_decode_PrimaryWDigest(st
 
 	_decode_PrimaryWDigest(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -847,7 +847,7 @@ static bool api_decode_trustAuthInOut(st
 
 	_decode_trustAuthInOut(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -920,7 +920,7 @@ static bool api_decode_trustDomainPasswo
 
 	_decode_trustDomainPasswords(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -993,7 +993,7 @@ static bool api_decode_ExtendedErrorInfo
 
 	_decode_ExtendedErrorInfo(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1066,7 +1066,7 @@ static bool api_decode_ForestTrustInfo(s
 
 	_decode_ForestTrustInfo(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
--- a/source3/librpc/gen_ndr/srv_drsuapi.c
+++ b/source3/librpc/gen_ndr/srv_drsuapi.c
@@ -52,7 +52,7 @@ static bool api_drsuapi_DsBind(struct pi
 
 	r->out.result = _drsuapi_DsBind(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -127,7 +127,7 @@ static bool api_drsuapi_DsUnbind(struct
 	r->out.bind_handle = r->in.bind_handle;
 	r->out.result = _drsuapi_DsUnbind(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -200,7 +200,7 @@ static bool api_drsuapi_DsReplicaSync(st
 
 	r->out.result = _drsuapi_DsReplicaSync(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -286,7 +286,7 @@ static bool api_drsuapi_DsGetNCChanges(s
 
 	r->out.result = _drsuapi_DsGetNCChanges(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -359,7 +359,7 @@ static bool api_drsuapi_DsReplicaUpdateR
 
 	r->out.result = _drsuapi_DsReplicaUpdateRefs(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -432,7 +432,7 @@ static bool api_drsuapi_DsReplicaAdd(str
 
 	r->out.result = _drsuapi_DsReplicaAdd(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -505,7 +505,7 @@ static bool api_drsuapi_DsReplicaDel(str
 
 	r->out.result = _drsuapi_DsReplicaDel(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -578,7 +578,7 @@ static bool api_drsuapi_DsReplicaMod(str
 
 	r->out.result = _drsuapi_DsReplicaMod(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -651,7 +651,7 @@ static bool api_DRSUAPI_VERIFY_NAMES(str
 
 	r->out.result = _DRSUAPI_VERIFY_NAMES(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -737,7 +737,7 @@ static bool api_drsuapi_DsGetMemberships
 
 	r->out.result = _drsuapi_DsGetMemberships(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -810,7 +810,7 @@ static bool api_DRSUAPI_INTER_DOMAIN_MOV
 
 	r->out.result = _DRSUAPI_INTER_DOMAIN_MOVE(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -896,7 +896,7 @@ static bool api_drsuapi_DsGetNT4ChangeLo
 
 	r->out.result = _drsuapi_DsGetNT4ChangeLog(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -982,7 +982,7 @@ static bool api_drsuapi_DsCrackNames(str
 
 	r->out.result = _drsuapi_DsCrackNames(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1068,7 +1068,7 @@ static bool api_drsuapi_DsWriteAccountSp
 
 	r->out.result = _drsuapi_DsWriteAccountSpn(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1154,7 +1154,7 @@ static bool api_drsuapi_DsRemoveDSServer
 
 	r->out.result = _drsuapi_DsRemoveDSServer(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1227,7 +1227,7 @@ static bool api_DRSUAPI_REMOVE_DS_DOMAIN
 
 	r->out.result = _DRSUAPI_REMOVE_DS_DOMAIN(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1313,7 +1313,7 @@ static bool api_drsuapi_DsGetDomainContr
 
 	r->out.result = _drsuapi_DsGetDomainControllerInfo(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1399,7 +1399,7 @@ static bool api_drsuapi_DsAddEntry(struc
 
 	r->out.result = _drsuapi_DsAddEntry(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1472,7 +1472,7 @@ static bool api_drsuapi_DsExecuteKCC(str
 
 	r->out.result = _drsuapi_DsExecuteKCC(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1558,7 +1558,7 @@ static bool api_drsuapi_DsReplicaGetInfo
 
 	r->out.result = _drsuapi_DsReplicaGetInfo(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1631,7 +1631,7 @@ static bool api_DRSUAPI_ADD_SID_HISTORY(
 
 	r->out.result = _DRSUAPI_ADD_SID_HISTORY(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1717,7 +1717,7 @@ static bool api_drsuapi_DsGetMemberships
 
 	r->out.result = _drsuapi_DsGetMemberships2(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1790,7 +1790,7 @@ static bool api_DRSUAPI_REPLICA_VERIFY_O
 
 	r->out.result = _DRSUAPI_REPLICA_VERIFY_OBJECTS(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1863,7 +1863,7 @@ static bool api_DRSUAPI_GET_OBJECT_EXIST
 
 	r->out.result = _DRSUAPI_GET_OBJECT_EXISTENCE(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1949,7 +1949,7 @@ static bool api_drsuapi_QuerySitesByCost
 
 	r->out.result = _drsuapi_QuerySitesByCost(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
--- a/source3/librpc/gen_ndr/srv_dsbackup.c
+++ b/source3/librpc/gen_ndr/srv_dsbackup.c
@@ -44,7 +44,7 @@ static bool api_HrRBackupPrepare(struct
 
 	_HrRBackupPrepare(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -117,7 +117,7 @@ static bool api_HrRBackupEnd(struct pipe
 
 	_HrRBackupEnd(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -190,7 +190,7 @@ static bool api_HrRBackupGetAttachmentIn
 
 	_HrRBackupGetAttachmentInformation(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -263,7 +263,7 @@ static bool api_HrRBackupOpenFile(struct
 
 	_HrRBackupOpenFile(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -336,7 +336,7 @@ static bool api_HrRBackupRead(struct pip
 
 	_HrRBackupRead(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -409,7 +409,7 @@ static bool api_HrRBackupClose(struct pi
 
 	_HrRBackupClose(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -482,7 +482,7 @@ static bool api_HrRBackupGetBackupLogs(s
 
 	_HrRBackupGetBackupLogs(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -555,7 +555,7 @@ static bool api_HrRBackupTruncateLogs(st
 
 	_HrRBackupTruncateLogs(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -628,7 +628,7 @@ static bool api_HrRBackupPing(struct pip
 
 	_HrRBackupPing(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -731,7 +731,7 @@ static bool api_HrRIsNTDSOnline(struct p
 
 	_HrRIsNTDSOnline(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -804,7 +804,7 @@ static bool api_HrRRestorePrepare(struct
 
 	_HrRRestorePrepare(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -877,7 +877,7 @@ static bool api_HrRRestoreRegister(struc
 
 	_HrRRestoreRegister(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -950,7 +950,7 @@ static bool api_HrRRestoreRegisterComple
 
 	_HrRRestoreRegisterComplete(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1023,7 +1023,7 @@ static bool api_HrRRestoreGetDatabaseLoc
 
 	_HrRRestoreGetDatabaseLocations(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1096,7 +1096,7 @@ static bool api_HrRRestoreEnd(struct pip
 
 	_HrRRestoreEnd(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1169,7 +1169,7 @@ static bool api_HrRRestoreSetCurrentLogN
 
 	_HrRRestoreSetCurrentLogNumber(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1242,7 +1242,7 @@ static bool api_HrRRestoreCheckLogsForBa
 
 	_HrRRestoreCheckLogsForBackup(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
--- a/source3/librpc/gen_ndr/srv_dssetup.c
+++ b/source3/librpc/gen_ndr/srv_dssetup.c
@@ -51,7 +51,7 @@ static bool api_dssetup_DsRoleGetPrimary
 
 	r->out.result = _dssetup_DsRoleGetPrimaryDomainInformation(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -124,7 +124,7 @@ static bool api_dssetup_DsRoleDnsNameToF
 
 	r->out.result = _dssetup_DsRoleDnsNameToFlatName(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -197,7 +197,7 @@ static bool api_dssetup_DsRoleDcAsDc(str
 
 	r->out.result = _dssetup_DsRoleDcAsDc(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -270,7 +270,7 @@ static bool api_dssetup_DsRoleDcAsReplic
 
 	r->out.result = _dssetup_DsRoleDcAsReplica(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -343,7 +343,7 @@ static bool api_dssetup_DsRoleDemoteDc(s
 
 	r->out.result = _dssetup_DsRoleDemoteDc(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -416,7 +416,7 @@ static bool api_dssetup_DsRoleGetDcOpera
 
 	r->out.result = _dssetup_DsRoleGetDcOperationProgress(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -489,7 +489,7 @@ static bool api_dssetup_DsRoleGetDcOpera
 
 	r->out.result = _dssetup_DsRoleGetDcOperationResults(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -562,7 +562,7 @@ static bool api_dssetup_DsRoleCancel(str
 
 	r->out.result = _dssetup_DsRoleCancel(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -635,7 +635,7 @@ static bool api_dssetup_DsRoleServerSave
 
 	r->out.result = _dssetup_DsRoleServerSaveStateForUpgrade(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -708,7 +708,7 @@ static bool api_dssetup_DsRoleUpgradeDow
 
 	r->out.result = _dssetup_DsRoleUpgradeDownlevelServer(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -781,7 +781,7 @@ static bool api_dssetup_DsRoleAbortDownl
 
 	r->out.result = _dssetup_DsRoleAbortDownlevelServerUpgrade(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
--- a/source3/librpc/gen_ndr/srv_echo.c
+++ b/source3/librpc/gen_ndr/srv_echo.c
@@ -51,7 +51,7 @@ static bool api_echo_AddOne(struct pipes
 
 	_echo_AddOne(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -131,7 +131,7 @@ static bool api_echo_EchoData(struct pip
 
 	_echo_EchoData(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -204,7 +204,7 @@ static bool api_echo_SinkData(struct pip
 
 	_echo_SinkData(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -284,7 +284,7 @@ static bool api_echo_SourceData(struct p
 
 	_echo_SourceData(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -364,7 +364,7 @@ static bool api_echo_TestCall(struct pip
 
 	_echo_TestCall(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -444,7 +444,7 @@ static bool api_echo_TestCall2(struct pi
 
 	r->out.result = _echo_TestCall2(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -517,7 +517,7 @@ static bool api_echo_TestSleep(struct pi
 
 	r->out.result = _echo_TestSleep(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -594,7 +594,7 @@ static bool api_echo_TestEnum(struct pip
 	r->out.foo3 = r->in.foo3;
 	_echo_TestEnum(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -669,7 +669,7 @@ static bool api_echo_TestSurrounding(str
 	r->out.data = r->in.data;
 	_echo_TestSurrounding(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -742,7 +742,7 @@ static bool api_echo_TestDoublePointer(s
 
 	r->out.result = _echo_TestDoublePointer(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
--- a/source3/librpc/gen_ndr/srv_efs.c
+++ b/source3/librpc/gen_ndr/srv_efs.c
@@ -51,7 +51,7 @@ static bool api_EfsRpcOpenFileRaw(struct
 
 	r->out.result = _EfsRpcOpenFileRaw(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -124,7 +124,7 @@ static bool api_EfsRpcReadFileRaw(struct
 
 	r->out.result = _EfsRpcReadFileRaw(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -197,7 +197,7 @@ static bool api_EfsRpcWriteFileRaw(struc
 
 	r->out.result = _EfsRpcWriteFileRaw(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -272,7 +272,7 @@ static bool api_EfsRpcCloseRaw(struct pi
 	r->out.pvContext = r->in.pvContext;
 	_EfsRpcCloseRaw(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -345,7 +345,7 @@ static bool api_EfsRpcEncryptFileSrv(str
 
 	r->out.result = _EfsRpcEncryptFileSrv(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -418,7 +418,7 @@ static bool api_EfsRpcDecryptFileSrv(str
 
 	r->out.result = _EfsRpcDecryptFileSrv(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -498,7 +498,7 @@ static bool api_EfsRpcQueryUsersOnFile(s
 
 	r->out.result = _EfsRpcQueryUsersOnFile(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -578,7 +578,7 @@ static bool api_EfsRpcQueryRecoveryAgent
 
 	r->out.result = _EfsRpcQueryRecoveryAgents(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -651,7 +651,7 @@ static bool api_EfsRpcRemoveUsersFromFil
 
 	r->out.result = _EfsRpcRemoveUsersFromFile(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -724,7 +724,7 @@ static bool api_EfsRpcAddUsersToFile(str
 
 	r->out.result = _EfsRpcAddUsersToFile(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -797,7 +797,7 @@ static bool api_EfsRpcSetFileEncryptionK
 
 	r->out.result = _EfsRpcSetFileEncryptionKey(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -870,7 +870,7 @@ static bool api_EfsRpcNotSupported(struc
 
 	r->out.result = _EfsRpcNotSupported(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -943,7 +943,7 @@ static bool api_EfsRpcFileKeyInfo(struct
 
 	r->out.result = _EfsRpcFileKeyInfo(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1016,7 +1016,7 @@ static bool api_EfsRpcDuplicateEncryptio
 
 	r->out.result = _EfsRpcDuplicateEncryptionInfoFile(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
--- a/source3/librpc/gen_ndr/srv_epmapper.c
+++ b/source3/librpc/gen_ndr/srv_epmapper.c
@@ -44,7 +44,7 @@ static bool api_epm_Insert(struct pipes_
 
 	r->out.result = _epm_Insert(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -117,7 +117,7 @@ static bool api_epm_Delete(struct pipes_
 
 	r->out.result = _epm_Delete(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -204,7 +204,7 @@ static bool api_epm_Lookup(struct pipes_
 
 	r->out.result = _epm_Lookup(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -291,7 +291,7 @@ static bool api_epm_Map(struct pipes_str
 
 	r->out.result = _epm_Map(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -366,7 +366,7 @@ static bool api_epm_LookupHandleFree(str
 	r->out.entry_handle = r->in.entry_handle;
 	r->out.result = _epm_LookupHandleFree(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -439,7 +439,7 @@ static bool api_epm_InqObject(struct pip
 
 	r->out.result = _epm_InqObject(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -512,7 +512,7 @@ static bool api_epm_MgmtDelete(struct pi
 
 	r->out.result = _epm_MgmtDelete(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -585,7 +585,7 @@ static bool api_epm_MapAuth(struct pipes
 
 	r->out.result = _epm_MapAuth(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
--- a/source3/librpc/gen_ndr/srv_eventlog6.c
+++ b/source3/librpc/gen_ndr/srv_eventlog6.c
@@ -75,7 +75,7 @@ static bool api_eventlog6_EvtRpcRegister
 
 	r->out.result = _eventlog6_EvtRpcRegisterRemoteSubscription(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -179,7 +179,7 @@ static bool api_eventlog6_EvtRpcRemoteSu
 
 	r->out.result = _eventlog6_EvtRpcRemoteSubscriptionNextAsync(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -283,7 +283,7 @@ static bool api_eventlog6_EvtRpcRemoteSu
 
 	r->out.result = _eventlog6_EvtRpcRemoteSubscriptionNext(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -356,7 +356,7 @@ static bool api_eventlog6_EvtRpcRemoteSu
 
 	r->out.result = _eventlog6_EvtRpcRemoteSubscriptionWaitAsync(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -436,7 +436,7 @@ static bool api_eventlog6_EvtRpcRegister
 
 	r->out.result = _eventlog6_EvtRpcRegisterControllableOperation(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -540,7 +540,7 @@ static bool api_eventlog6_EvtRpcRegister
 
 	r->out.result = _eventlog6_EvtRpcRegisterLogQuery(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -620,7 +620,7 @@ static bool api_eventlog6_EvtRpcClearLog
 
 	r->out.result = _eventlog6_EvtRpcClearLog(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -700,7 +700,7 @@ static bool api_eventlog6_EvtRpcExportLo
 
 	r->out.result = _eventlog6_EvtRpcExportLog(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -780,7 +780,7 @@ static bool api_eventlog6_EvtRpcLocalize
 
 	r->out.result = _eventlog6_EvtRpcLocalizeExportLog(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -878,7 +878,7 @@ static bool api_eventlog6_EvtRpcMessageR
 
 	r->out.result = _eventlog6_EvtRpcMessageRender(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -976,7 +976,7 @@ static bool api_eventlog6_EvtRpcMessageR
 
 	r->out.result = _eventlog6_EvtRpcMessageRenderDefault(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1080,7 +1080,7 @@ static bool api_eventlog6_EvtRpcQueryNex
 
 	r->out.result = _eventlog6_EvtRpcQueryNext(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1160,7 +1160,7 @@ static bool api_eventlog6_EvtRpcQuerySee
 
 	r->out.result = _eventlog6_EvtRpcQuerySeek(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1235,7 +1235,7 @@ static bool api_eventlog6_EvtRpcClose(st
 	r->out.handle = r->in.handle;
 	r->out.result = _eventlog6_EvtRpcClose(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1308,7 +1308,7 @@ static bool api_eventlog6_EvtRpcCancel(s
 
 	r->out.result = _eventlog6_EvtRpcCancel(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1381,7 +1381,7 @@ static bool api_eventlog6_EvtRpcAssertCo
 
 	r->out.result = _eventlog6_EvtRpcAssertConfig(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1454,7 +1454,7 @@ static bool api_eventlog6_EvtRpcRetractC
 
 	r->out.result = _eventlog6_EvtRpcRetractConfig(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1540,7 +1540,7 @@ static bool api_eventlog6_EvtRpcOpenLogH
 
 	r->out.result = _eventlog6_EvtRpcOpenLogHandle(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1626,7 +1626,7 @@ static bool api_eventlog6_EvtRpcGetLogFi
 
 	r->out.result = _eventlog6_EvtRpcGetLogFileInfo(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1712,7 +1712,7 @@ static bool api_eventlog6_EvtRpcGetChann
 
 	r->out.result = _eventlog6_EvtRpcGetChannelList(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1792,7 +1792,7 @@ static bool api_eventlog6_EvtRpcGetChann
 
 	r->out.result = _eventlog6_EvtRpcGetChannelConfig(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1872,7 +1872,7 @@ static bool api_eventlog6_EvtRpcPutChann
 
 	r->out.result = _eventlog6_EvtRpcPutChannelConfig(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1958,7 +1958,7 @@ static bool api_eventlog6_EvtRpcGetPubli
 
 	r->out.result = _eventlog6_EvtRpcGetPublisherList(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2044,7 +2044,7 @@ static bool api_eventlog6_EvtRpcGetPubli
 
 	r->out.result = _eventlog6_EvtRpcGetPublisherListForChannel(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2130,7 +2130,7 @@ static bool api_eventlog6_EvtRpcGetPubli
 
 	r->out.result = _eventlog6_EvtRpcGetPublisherMetadata(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2210,7 +2210,7 @@ static bool api_eventlog6_EvtRpcGetPubli
 
 	r->out.result = _eventlog6_EvtRpcGetPublisherResourceMetadata(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2290,7 +2290,7 @@ static bool api_eventlog6_EvtRpcGetEvent
 
 	r->out.result = _eventlog6_EvtRpcGetEventMetadataEnum(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2376,7 +2376,7 @@ static bool api_eventlog6_EvtRpcGetNextE
 
 	r->out.result = _eventlog6_EvtRpcGetNextEventMetadata(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2456,7 +2456,7 @@ static bool api_eventlog6_EvtRpcGetClass
 
 	r->out.result = _eventlog6_EvtRpcGetClassicLogDisplayName(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
--- a/source3/librpc/gen_ndr/srv_eventlog.c
+++ b/source3/librpc/gen_ndr/srv_eventlog.c
@@ -44,7 +44,7 @@ static bool api_eventlog_ClearEventLogW(
 
 	r->out.result = _eventlog_ClearEventLogW(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -117,7 +117,7 @@ static bool api_eventlog_BackupEventLogW
 
 	r->out.result = _eventlog_BackupEventLogW(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -192,7 +192,7 @@ static bool api_eventlog_CloseEventLog(s
 	r->out.handle = r->in.handle;
 	r->out.result = _eventlog_CloseEventLog(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -267,7 +267,7 @@ static bool api_eventlog_DeregisterEvent
 	r->out.handle = r->in.handle;
 	r->out.result = _eventlog_DeregisterEventSource(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -347,7 +347,7 @@ static bool api_eventlog_GetNumRecords(s
 
 	r->out.result = _eventlog_GetNumRecords(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -427,7 +427,7 @@ static bool api_eventlog_GetOldestRecord
 
 	r->out.result = _eventlog_GetOldestRecord(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -500,7 +500,7 @@ static bool api_eventlog_ChangeNotify(st
 
 	r->out.result = _eventlog_ChangeNotify(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -580,7 +580,7 @@ static bool api_eventlog_OpenEventLogW(s
 
 	r->out.result = _eventlog_OpenEventLogW(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -660,7 +660,7 @@ static bool api_eventlog_RegisterEventSo
 
 	r->out.result = _eventlog_RegisterEventSourceW(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -740,7 +740,7 @@ static bool api_eventlog_OpenBackupEvent
 
 	r->out.result = _eventlog_OpenBackupEventLogW(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -832,7 +832,7 @@ static bool api_eventlog_ReadEventLogW(s
 
 	r->out.result = _eventlog_ReadEventLogW(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -908,7 +908,7 @@ static bool api_eventlog_ReportEventW(st
 	r->out.time_written = r->in.time_written;
 	r->out.result = _eventlog_ReportEventW(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -981,7 +981,7 @@ static bool api_eventlog_ClearEventLogA(
 
 	r->out.result = _eventlog_ClearEventLogA(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1054,7 +1054,7 @@ static bool api_eventlog_BackupEventLogA
 
 	r->out.result = _eventlog_BackupEventLogA(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1127,7 +1127,7 @@ static bool api_eventlog_OpenEventLogA(s
 
 	r->out.result = _eventlog_OpenEventLogA(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1200,7 +1200,7 @@ static bool api_eventlog_RegisterEventSo
 
 	r->out.result = _eventlog_RegisterEventSourceA(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1273,7 +1273,7 @@ static bool api_eventlog_OpenBackupEvent
 
 	r->out.result = _eventlog_OpenBackupEventLogA(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1346,7 +1346,7 @@ static bool api_eventlog_ReadEventLogA(s
 
 	r->out.result = _eventlog_ReadEventLogA(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1419,7 +1419,7 @@ static bool api_eventlog_ReportEventA(st
 
 	r->out.result = _eventlog_ReportEventA(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1492,7 +1492,7 @@ static bool api_eventlog_RegisterCluster
 
 	r->out.result = _eventlog_RegisterClusterSvc(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1565,7 +1565,7 @@ static bool api_eventlog_DeregisterClust
 
 	r->out.result = _eventlog_DeregisterClusterSvc(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1638,7 +1638,7 @@ static bool api_eventlog_WriteClusterEve
 
 	r->out.result = _eventlog_WriteClusterEvents(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1724,7 +1724,7 @@ static bool api_eventlog_GetLogInformati
 
 	r->out.result = _eventlog_GetLogInformation(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1797,7 +1797,7 @@ static bool api_eventlog_FlushEventLog(s
 
 	r->out.result = _eventlog_FlushEventLog(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1873,7 +1873,7 @@ static bool api_eventlog_ReportEventAndS
 	r->out.time_written = r->in.time_written;
 	r->out.result = _eventlog_ReportEventAndSourceW(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
--- a/source3/librpc/gen_ndr/srv_frsapi.c
+++ b/source3/librpc/gen_ndr/srv_frsapi.c
@@ -44,7 +44,7 @@ static bool api_FRSAPI_VERIFY_PROMOTION(
 
 	_FRSAPI_VERIFY_PROMOTION(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -117,7 +117,7 @@ static bool api_FRSAPI_PROMOTION_STATUS(
 
 	_FRSAPI_PROMOTION_STATUS(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -190,7 +190,7 @@ static bool api_FRSAPI_START_DEMOTION(st
 
 	_FRSAPI_START_DEMOTION(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -263,7 +263,7 @@ static bool api_FRSAPI_COMMIT_DEMOTION(s
 
 	_FRSAPI_COMMIT_DEMOTION(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -336,7 +336,7 @@ static bool api_frsapi_SetDsPollingInter
 
 	r->out.result = _frsapi_SetDsPollingIntervalW(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -428,7 +428,7 @@ static bool api_frsapi_GetDsPollingInter
 
 	r->out.result = _frsapi_GetDsPollingIntervalW(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -501,7 +501,7 @@ static bool api_FRSAPI_VERIFY_PROMOTION_
 
 	_FRSAPI_VERIFY_PROMOTION_W(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -576,7 +576,7 @@ static bool api_frsapi_InfoW(struct pipe
 	r->out.info = r->in.info;
 	r->out.result = _frsapi_InfoW(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -674,7 +674,7 @@ static bool api_frsapi_IsPathReplicated(
 
 	r->out.result = _frsapi_IsPathReplicated(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -747,7 +747,7 @@ static bool api_frsapi_WriterCommand(str
 
 	r->out.result = _frsapi_WriterCommand(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -820,7 +820,7 @@ static bool api_frsapi_ForceReplication(
 
 	r->out.result = _frsapi_ForceReplication(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
--- a/source3/librpc/gen_ndr/srv_frsrpc.c
+++ b/source3/librpc/gen_ndr/srv_frsrpc.c
@@ -44,7 +44,7 @@ static bool api_frsrpc_FrsSendCommPkt(st
 
 	r->out.result = _frsrpc_FrsSendCommPkt(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -117,7 +117,7 @@ static bool api_frsrpc_FrsVerifyPromotio
 
 	r->out.result = _frsrpc_FrsVerifyPromotionParent(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -192,7 +192,7 @@ static bool api_frsrpc_FrsStartPromotion
 	r->out.parent_guid = r->in.parent_guid;
 	r->out.result = _frsrpc_FrsStartPromotionParent(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -265,7 +265,7 @@ static bool api_frsrpc_FrsNOP(struct pip
 
 	r->out.result = _frsrpc_FrsNOP(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -338,7 +338,7 @@ static bool api_FRSRPC_BACKUP_COMPLETE(s
 
 	_FRSRPC_BACKUP_COMPLETE(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -411,7 +411,7 @@ static bool api_FRSRPC_BACKUP_COMPLETE_5
 
 	_FRSRPC_BACKUP_COMPLETE_5(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -484,7 +484,7 @@ static bool api_FRSRPC_BACKUP_COMPLETE_6
 
 	_FRSRPC_BACKUP_COMPLETE_6(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -557,7 +557,7 @@ static bool api_FRSRPC_BACKUP_COMPLETE_7
 
 	_FRSRPC_BACKUP_COMPLETE_7(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -630,7 +630,7 @@ static bool api_FRSRPC_BACKUP_COMPLETE_8
 
 	_FRSRPC_BACKUP_COMPLETE_8(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -703,7 +703,7 @@ static bool api_FRSRPC_BACKUP_COMPLETE_9
 
 	_FRSRPC_BACKUP_COMPLETE_9(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -776,7 +776,7 @@ static bool api_FRSRPC_VERIFY_PROMOTION_
 
 	_FRSRPC_VERIFY_PROMOTION_PARENT_EX(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
--- a/source3/librpc/gen_ndr/srv_frstrans.c
+++ b/source3/librpc/gen_ndr/srv_frstrans.c
@@ -44,7 +44,7 @@ static bool api_frstrans_CheckConnectivi
 
 	r->out.result = _frstrans_CheckConnectivity(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -130,7 +130,7 @@ static bool api_frstrans_EstablishConnec
 
 	r->out.result = _frstrans_EstablishConnection(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -203,7 +203,7 @@ static bool api_frstrans_EstablishSessio
 
 	r->out.result = _frstrans_EstablishSession(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -307,7 +307,7 @@ static bool api_frstrans_RequestUpdates(
 
 	r->out.result = _frstrans_RequestUpdates(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -380,7 +380,7 @@ static bool api_frstrans_RequestVersionV
 
 	r->out.result = _frstrans_RequestVersionVector(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -460,7 +460,7 @@ static bool api_frstrans_AsyncPoll(struc
 
 	r->out.result = _frstrans_AsyncPoll(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -533,7 +533,7 @@ static bool api_FRSTRANS_REQUEST_RECORDS
 
 	_FRSTRANS_REQUEST_RECORDS(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -606,7 +606,7 @@ static bool api_FRSTRANS_UPDATE_CANCEL(s
 
 	_FRSTRANS_UPDATE_CANCEL(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -679,7 +679,7 @@ static bool api_FRSTRANS_RAW_GET_FILE_DA
 
 	_FRSTRANS_RAW_GET_FILE_DATA(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -752,7 +752,7 @@ static bool api_FRSTRANS_RDC_GET_SIGNATU
 
 	_FRSTRANS_RDC_GET_SIGNATURES(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -825,7 +825,7 @@ static bool api_FRSTRANS_RDC_PUSH_SOURCE
 
 	_FRSTRANS_RDC_PUSH_SOURCE_NEEDS(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -898,7 +898,7 @@ static bool api_FRSTRANS_RDC_GET_FILE_DA
 
 	_FRSTRANS_RDC_GET_FILE_DATA(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -971,7 +971,7 @@ static bool api_FRSTRANS_RDC_CLOSE(struc
 
 	_FRSTRANS_RDC_CLOSE(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1077,7 +1077,7 @@ static bool api_frstrans_InitializeFileT
 
 	r->out.result = _frstrans_InitializeFileTransferAsync(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1150,7 +1150,7 @@ static bool api_FRSTRANS_OPNUM_0E_NOT_US
 
 	_FRSTRANS_OPNUM_0E_NOT_USED_ON_THE_WIRE(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1230,7 +1230,7 @@ static bool api_frstrans_RawGetFileDataA
 
 	r->out.result = _frstrans_RawGetFileDataAsync(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1310,7 +1310,7 @@ static bool api_frstrans_RdcGetFileDataA
 
 	r->out.result = _frstrans_RdcGetFileDataAsync(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
--- a/source3/librpc/gen_ndr/srv_initshutdown.c
+++ b/source3/librpc/gen_ndr/srv_initshutdown.c
@@ -44,7 +44,7 @@ static bool api_initshutdown_Init(struct
 
 	r->out.result = _initshutdown_Init(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -117,7 +117,7 @@ static bool api_initshutdown_Abort(struc
 
 	r->out.result = _initshutdown_Abort(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -190,7 +190,7 @@ static bool api_initshutdown_InitEx(stru
 
 	r->out.result = _initshutdown_InitEx(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
--- a/source3/librpc/gen_ndr/srv_keysvc.c
+++ b/source3/librpc/gen_ndr/srv_keysvc.c
@@ -44,7 +44,7 @@ static bool api_keysvc_Unknown0(struct p
 
 	r->out.result = _keysvc_Unknown0(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
--- a/source3/librpc/gen_ndr/srv_krb5pac.c
+++ b/source3/librpc/gen_ndr/srv_krb5pac.c
@@ -44,7 +44,7 @@ static bool api_decode_pac(struct pipes_
 
 	_decode_pac(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -117,7 +117,7 @@ static bool api_decode_pac_raw(struct pi
 
 	_decode_pac_raw(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -190,7 +190,7 @@ static bool api_decode_login_info(struct
 
 	_decode_login_info(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -263,7 +263,7 @@ static bool api_decode_login_info_ctr(st
 
 	_decode_login_info_ctr(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -336,7 +336,7 @@ static bool api_decode_pac_validate(stru
 
 	_decode_pac_validate(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
--- a/source3/librpc/gen_ndr/srv_libnetapi.c
+++ b/source3/librpc/gen_ndr/srv_libnetapi.c
@@ -44,7 +44,7 @@ static bool api_NetJoinDomain(struct pip
 
 	r->out.result = _NetJoinDomain(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -117,7 +117,7 @@ static bool api_NetUnjoinDomain(struct p
 
 	r->out.result = _NetUnjoinDomain(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -203,7 +203,7 @@ static bool api_NetGetJoinInformation(st
 
 	r->out.result = _NetGetJoinInformation(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -289,7 +289,7 @@ static bool api_NetGetJoinableOUs(struct
 
 	r->out.result = _NetGetJoinableOUs(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -362,7 +362,7 @@ static bool api_NetRenameMachineInDomain
 
 	r->out.result = _NetRenameMachineInDomain(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -442,7 +442,7 @@ static bool api_NetServerGetInfo(struct
 
 	r->out.result = _NetServerGetInfo(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -522,7 +522,7 @@ static bool api_NetServerSetInfo(struct
 
 	r->out.result = _NetServerSetInfo(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -602,7 +602,7 @@ static bool api_NetGetDCName(struct pipe
 
 	r->out.result = _NetGetDCName(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -682,7 +682,7 @@ static bool api_NetGetAnyDCName(struct p
 
 	r->out.result = _NetGetAnyDCName(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -762,7 +762,7 @@ static bool api_DsGetDcName(struct pipes
 
 	r->out.result = _DsGetDcName(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -842,7 +842,7 @@ static bool api_NetUserAdd(struct pipes_
 
 	r->out.result = _NetUserAdd(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -915,7 +915,7 @@ static bool api_NetUserDel(struct pipes_
 
 	r->out.result = _NetUserDel(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1008,7 +1008,7 @@ static bool api_NetUserEnum(struct pipes
 
 	r->out.result = _NetUserEnum(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1081,7 +1081,7 @@ static bool api_NetUserChangePassword(st
 
 	r->out.result = _NetUserChangePassword(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1161,7 +1161,7 @@ static bool api_NetUserGetInfo(struct pi
 
 	r->out.result = _NetUserGetInfo(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1241,7 +1241,7 @@ static bool api_NetUserSetInfo(struct pi
 
 	r->out.result = _NetUserSetInfo(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1333,7 +1333,7 @@ static bool api_NetUserGetGroups(struct
 
 	r->out.result = _NetUserGetGroups(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1406,7 +1406,7 @@ static bool api_NetUserSetGroups(struct
 
 	r->out.result = _NetUserSetGroups(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1498,7 +1498,7 @@ static bool api_NetUserGetLocalGroups(st
 
 	r->out.result = _NetUserGetLocalGroups(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1578,7 +1578,7 @@ static bool api_NetUserModalsGet(struct
 
 	r->out.result = _NetUserModalsGet(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1658,7 +1658,7 @@ static bool api_NetUserModalsSet(struct
 
 	r->out.result = _NetUserModalsSet(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1744,7 +1744,7 @@ static bool api_NetQueryDisplayInformati
 
 	r->out.result = _NetQueryDisplayInformation(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1824,7 +1824,7 @@ static bool api_NetGroupAdd(struct pipes
 
 	r->out.result = _NetGroupAdd(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1897,7 +1897,7 @@ static bool api_NetGroupDel(struct pipes
 
 	r->out.result = _NetGroupDel(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1990,7 +1990,7 @@ static bool api_NetGroupEnum(struct pipe
 
 	r->out.result = _NetGroupEnum(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2070,7 +2070,7 @@ static bool api_NetGroupSetInfo(struct p
 
 	r->out.result = _NetGroupSetInfo(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2150,7 +2150,7 @@ static bool api_NetGroupGetInfo(struct p
 
 	r->out.result = _NetGroupGetInfo(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2223,7 +2223,7 @@ static bool api_NetGroupAddUser(struct p
 
 	r->out.result = _NetGroupAddUser(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2296,7 +2296,7 @@ static bool api_NetGroupDelUser(struct p
 
 	r->out.result = _NetGroupDelUser(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2389,7 +2389,7 @@ static bool api_NetGroupGetUsers(struct
 
 	r->out.result = _NetGroupGetUsers(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2462,7 +2462,7 @@ static bool api_NetGroupSetUsers(struct
 
 	r->out.result = _NetGroupSetUsers(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2542,7 +2542,7 @@ static bool api_NetLocalGroupAdd(struct
 
 	r->out.result = _NetLocalGroupAdd(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2615,7 +2615,7 @@ static bool api_NetLocalGroupDel(struct
 
 	r->out.result = _NetLocalGroupDel(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2695,7 +2695,7 @@ static bool api_NetLocalGroupGetInfo(str
 
 	r->out.result = _NetLocalGroupGetInfo(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2775,7 +2775,7 @@ static bool api_NetLocalGroupSetInfo(str
 
 	r->out.result = _NetLocalGroupSetInfo(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2868,7 +2868,7 @@ static bool api_NetLocalGroupEnum(struct
 
 	r->out.result = _NetLocalGroupEnum(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2941,7 +2941,7 @@ static bool api_NetLocalGroupAddMembers(
 
 	r->out.result = _NetLocalGroupAddMembers(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -3014,7 +3014,7 @@ static bool api_NetLocalGroupDelMembers(
 
 	r->out.result = _NetLocalGroupDelMembers(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -3107,7 +3107,7 @@ static bool api_NetLocalGroupGetMembers(
 
 	r->out.result = _NetLocalGroupGetMembers(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -3180,7 +3180,7 @@ static bool api_NetLocalGroupSetMembers(
 
 	r->out.result = _NetLocalGroupSetMembers(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -3260,7 +3260,7 @@ static bool api_NetRemoteTOD(struct pipe
 
 	r->out.result = _NetRemoteTOD(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -3340,7 +3340,7 @@ static bool api_NetShareAdd(struct pipes
 
 	r->out.result = _NetShareAdd(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -3413,7 +3413,7 @@ static bool api_NetShareDel(struct pipes
 
 	r->out.result = _NetShareDel(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -3506,7 +3506,7 @@ static bool api_NetShareEnum(struct pipe
 
 	r->out.result = _NetShareEnum(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -3586,7 +3586,7 @@ static bool api_NetShareGetInfo(struct p
 
 	r->out.result = _NetShareGetInfo(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -3666,7 +3666,7 @@ static bool api_NetShareSetInfo(struct p
 
 	r->out.result = _NetShareSetInfo(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -3739,7 +3739,7 @@ static bool api_NetFileClose(struct pipe
 
 	r->out.result = _NetFileClose(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -3819,7 +3819,7 @@ static bool api_NetFileGetInfo(struct pi
 
 	r->out.result = _NetFileGetInfo(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -3912,7 +3912,7 @@ static bool api_NetFileEnum(struct pipes
 
 	r->out.result = _NetFileEnum(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -3985,7 +3985,7 @@ static bool api_NetShutdownInit(struct p
 
 	r->out.result = _NetShutdownInit(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -4058,7 +4058,7 @@ static bool api_NetShutdownAbort(struct
 
 	r->out.result = _NetShutdownAbort(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -4138,7 +4138,7 @@ static bool api_I_NetLogonControl(struct
 
 	r->out.result = _I_NetLogonControl(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -4218,7 +4218,7 @@ static bool api_I_NetLogonControl2(struc
 
 	r->out.result = _I_NetLogonControl2(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
--- a/source3/librpc/gen_ndr/srv_lsa.c
+++ b/source3/librpc/gen_ndr/srv_lsa.c
@@ -46,7 +46,7 @@ static bool api_lsa_Close(struct pipes_s
 	r->out.handle = r->in.handle;
 	r->out.result = _lsa_Close(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -119,7 +119,7 @@ static bool api_lsa_Delete(struct pipes_
 
 	r->out.result = _lsa_Delete(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -200,7 +200,7 @@ static bool api_lsa_EnumPrivs(struct pip
 
 	r->out.result = _lsa_EnumPrivs(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -280,7 +280,7 @@ static bool api_lsa_QuerySecurity(struct
 
 	r->out.result = _lsa_QuerySecurity(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -353,7 +353,7 @@ static bool api_lsa_SetSecObj(struct pip
 
 	r->out.result = _lsa_SetSecObj(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -426,7 +426,7 @@ static bool api_lsa_ChangePassword(struc
 
 	r->out.result = _lsa_ChangePassword(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -506,7 +506,7 @@ static bool api_lsa_OpenPolicy(struct pi
 
 	r->out.result = _lsa_OpenPolicy(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -586,7 +586,7 @@ static bool api_lsa_QueryInfoPolicy(stru
 
 	r->out.result = _lsa_QueryInfoPolicy(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -659,7 +659,7 @@ static bool api_lsa_SetInfoPolicy(struct
 
 	r->out.result = _lsa_SetInfoPolicy(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -732,7 +732,7 @@ static bool api_lsa_ClearAuditLog(struct
 
 	r->out.result = _lsa_ClearAuditLog(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -812,7 +812,7 @@ static bool api_lsa_CreateAccount(struct
 
 	r->out.result = _lsa_CreateAccount(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -893,7 +893,7 @@ static bool api_lsa_EnumAccounts(struct
 
 	r->out.result = _lsa_EnumAccounts(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -973,7 +973,7 @@ static bool api_lsa_CreateTrustedDomain(
 
 	r->out.result = _lsa_CreateTrustedDomain(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1054,7 +1054,7 @@ static bool api_lsa_EnumTrustDom(struct
 
 	r->out.result = _lsa_EnumTrustDom(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1136,7 +1136,7 @@ static bool api_lsa_LookupNames(struct p
 
 	r->out.result = _lsa_LookupNames(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1218,7 +1218,7 @@ static bool api_lsa_LookupSids(struct pi
 
 	r->out.result = _lsa_LookupSids(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1298,7 +1298,7 @@ static bool api_lsa_CreateSecret(struct
 
 	r->out.result = _lsa_CreateSecret(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1378,7 +1378,7 @@ static bool api_lsa_OpenAccount(struct p
 
 	r->out.result = _lsa_OpenAccount(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1458,7 +1458,7 @@ static bool api_lsa_EnumPrivsAccount(str
 
 	r->out.result = _lsa_EnumPrivsAccount(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1531,7 +1531,7 @@ static bool api_lsa_AddPrivilegesToAccou
 
 	r->out.result = _lsa_AddPrivilegesToAccount(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1604,7 +1604,7 @@ static bool api_lsa_RemovePrivilegesFrom
 
 	r->out.result = _lsa_RemovePrivilegesFromAccount(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1677,7 +1677,7 @@ static bool api_lsa_GetQuotasForAccount(
 
 	r->out.result = _lsa_GetQuotasForAccount(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1750,7 +1750,7 @@ static bool api_lsa_SetQuotasForAccount(
 
 	r->out.result = _lsa_SetQuotasForAccount(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1830,7 +1830,7 @@ static bool api_lsa_GetSystemAccessAccou
 
 	r->out.result = _lsa_GetSystemAccessAccount(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1903,7 +1903,7 @@ static bool api_lsa_SetSystemAccessAccou
 
 	r->out.result = _lsa_SetSystemAccessAccount(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1983,7 +1983,7 @@ static bool api_lsa_OpenTrustedDomain(st
 
 	r->out.result = _lsa_OpenTrustedDomain(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2063,7 +2063,7 @@ static bool api_lsa_QueryTrustedDomainIn
 
 	r->out.result = _lsa_QueryTrustedDomainInfo(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2136,7 +2136,7 @@ static bool api_lsa_SetInformationTruste
 
 	r->out.result = _lsa_SetInformationTrustedDomain(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2216,7 +2216,7 @@ static bool api_lsa_OpenSecret(struct pi
 
 	r->out.result = _lsa_OpenSecret(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2289,7 +2289,7 @@ static bool api_lsa_SetSecret(struct pip
 
 	r->out.result = _lsa_SetSecret(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2367,7 +2367,7 @@ static bool api_lsa_QuerySecret(struct p
 	r->out.old_mtime = r->in.old_mtime;
 	r->out.result = _lsa_QuerySecret(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2447,7 +2447,7 @@ static bool api_lsa_LookupPrivValue(stru
 
 	r->out.result = _lsa_LookupPrivValue(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2527,7 +2527,7 @@ static bool api_lsa_LookupPrivName(struc
 
 	r->out.result = _lsa_LookupPrivName(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2613,7 +2613,7 @@ static bool api_lsa_LookupPrivDisplayNam
 
 	r->out.result = _lsa_LookupPrivDisplayName(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2688,7 +2688,7 @@ static bool api_lsa_DeleteObject(struct
 	r->out.handle = r->in.handle;
 	r->out.result = _lsa_DeleteObject(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2768,7 +2768,7 @@ static bool api_lsa_EnumAccountsWithUser
 
 	r->out.result = _lsa_EnumAccountsWithUserRight(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2848,7 +2848,7 @@ static bool api_lsa_EnumAccountRights(st
 
 	r->out.result = _lsa_EnumAccountRights(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2921,7 +2921,7 @@ static bool api_lsa_AddAccountRights(str
 
 	r->out.result = _lsa_AddAccountRights(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2994,7 +2994,7 @@ static bool api_lsa_RemoveAccountRights(
 
 	r->out.result = _lsa_RemoveAccountRights(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -3074,7 +3074,7 @@ static bool api_lsa_QueryTrustedDomainIn
 
 	r->out.result = _lsa_QueryTrustedDomainInfoBySid(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -3147,7 +3147,7 @@ static bool api_lsa_SetTrustedDomainInfo
 
 	r->out.result = _lsa_SetTrustedDomainInfo(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -3220,7 +3220,7 @@ static bool api_lsa_DeleteTrustedDomain(
 
 	r->out.result = _lsa_DeleteTrustedDomain(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -3293,7 +3293,7 @@ static bool api_lsa_StorePrivateData(str
 
 	r->out.result = _lsa_StorePrivateData(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -3368,7 +3368,7 @@ static bool api_lsa_RetrievePrivateData(
 	r->out.val = r->in.val;
 	r->out.result = _lsa_RetrievePrivateData(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -3448,7 +3448,7 @@ static bool api_lsa_OpenPolicy2(struct p
 
 	r->out.result = _lsa_OpenPolicy2(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -3524,7 +3524,7 @@ static bool api_lsa_GetUserName(struct p
 	r->out.authority_name = r->in.authority_name;
 	r->out.result = _lsa_GetUserName(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -3604,7 +3604,7 @@ static bool api_lsa_QueryInfoPolicy2(str
 
 	r->out.result = _lsa_QueryInfoPolicy2(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -3677,7 +3677,7 @@ static bool api_lsa_SetInfoPolicy2(struc
 
 	r->out.result = _lsa_SetInfoPolicy2(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -3757,7 +3757,7 @@ static bool api_lsa_QueryTrustedDomainIn
 
 	r->out.result = _lsa_QueryTrustedDomainInfoByName(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -3830,7 +3830,7 @@ static bool api_lsa_SetTrustedDomainInfo
 
 	r->out.result = _lsa_SetTrustedDomainInfoByName(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -3911,7 +3911,7 @@ static bool api_lsa_EnumTrustedDomainsEx
 
 	r->out.result = _lsa_EnumTrustedDomainsEx(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -3991,7 +3991,7 @@ static bool api_lsa_CreateTrustedDomainE
 
 	r->out.result = _lsa_CreateTrustedDomainEx(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -4066,7 +4066,7 @@ static bool api_lsa_CloseTrustedDomainEx
 	r->out.handle = r->in.handle;
 	r->out.result = _lsa_CloseTrustedDomainEx(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -4146,7 +4146,7 @@ static bool api_lsa_QueryDomainInformati
 
 	r->out.result = _lsa_QueryDomainInformationPolicy(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -4219,7 +4219,7 @@ static bool api_lsa_SetDomainInformation
 
 	r->out.result = _lsa_SetDomainInformationPolicy(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -4299,7 +4299,7 @@ static bool api_lsa_OpenTrustedDomainByN
 
 	r->out.result = _lsa_OpenTrustedDomainByName(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -4372,7 +4372,7 @@ static bool api_lsa_TestCall(struct pipe
 
 	r->out.result = _lsa_TestCall(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -4454,7 +4454,7 @@ static bool api_lsa_LookupSids2(struct p
 
 	r->out.result = _lsa_LookupSids2(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -4536,7 +4536,7 @@ static bool api_lsa_LookupNames2(struct
 
 	r->out.result = _lsa_LookupNames2(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -4616,7 +4616,7 @@ static bool api_lsa_CreateTrustedDomainE
 
 	r->out.result = _lsa_CreateTrustedDomainEx2(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -4689,7 +4689,7 @@ static bool api_lsa_CREDRWRITE(struct pi
 
 	r->out.result = _lsa_CREDRWRITE(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -4762,7 +4762,7 @@ static bool api_lsa_CREDRREAD(struct pip
 
 	r->out.result = _lsa_CREDRREAD(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -4835,7 +4835,7 @@ static bool api_lsa_CREDRENUMERATE(struc
 
 	r->out.result = _lsa_CREDRENUMERATE(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -4908,7 +4908,7 @@ static bool api_lsa_CREDRWRITEDOMAINCRED
 
 	r->out.result = _lsa_CREDRWRITEDOMAINCREDENTIALS(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -4981,7 +4981,7 @@ static bool api_lsa_CREDRREADDOMAINCREDE
 
 	r->out.result = _lsa_CREDRREADDOMAINCREDENTIALS(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -5054,7 +5054,7 @@ static bool api_lsa_CREDRDELETE(struct p
 
 	r->out.result = _lsa_CREDRDELETE(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -5127,7 +5127,7 @@ static bool api_lsa_CREDRGETTARGETINFO(s
 
 	r->out.result = _lsa_CREDRGETTARGETINFO(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -5200,7 +5200,7 @@ static bool api_lsa_CREDRPROFILELOADED(s
 
 	r->out.result = _lsa_CREDRPROFILELOADED(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -5282,7 +5282,7 @@ static bool api_lsa_LookupNames3(struct
 
 	r->out.result = _lsa_LookupNames3(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -5355,7 +5355,7 @@ static bool api_lsa_CREDRGETSESSIONTYPES
 
 	r->out.result = _lsa_CREDRGETSESSIONTYPES(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -5428,7 +5428,7 @@ static bool api_lsa_LSARREGISTERAUDITEVE
 
 	r->out.result = _lsa_LSARREGISTERAUDITEVENT(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -5501,7 +5501,7 @@ static bool api_lsa_LSARGENAUDITEVENT(st
 
 	r->out.result = _lsa_LSARGENAUDITEVENT(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -5574,7 +5574,7 @@ static bool api_lsa_LSARUNREGISTERAUDITE
 
 	r->out.result = _lsa_LSARUNREGISTERAUDITEVENT(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -5654,7 +5654,7 @@ static bool api_lsa_lsaRQueryForestTrust
 
 	r->out.result = _lsa_lsaRQueryForestTrustInformation(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -5734,7 +5734,7 @@ static bool api_lsa_lsaRSetForestTrustIn
 
 	r->out.result = _lsa_lsaRSetForestTrustInformation(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -5807,7 +5807,7 @@ static bool api_lsa_CREDRRENAME(struct p
 
 	r->out.result = _lsa_CREDRRENAME(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -5889,7 +5889,7 @@ static bool api_lsa_LookupSids3(struct p
 
 	r->out.result = _lsa_LookupSids3(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -5971,7 +5971,7 @@ static bool api_lsa_LookupNames4(struct
 
 	r->out.result = _lsa_LookupNames4(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -6044,7 +6044,7 @@ static bool api_lsa_LSAROPENPOLICYSCE(st
 
 	r->out.result = _lsa_LSAROPENPOLICYSCE(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -6117,7 +6117,7 @@ static bool api_lsa_LSARADTREGISTERSECUR
 
 	r->out.result = _lsa_LSARADTREGISTERSECURITYEVENTSOURCE(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -6190,7 +6190,7 @@ static bool api_lsa_LSARADTUNREGISTERSEC
 
 	r->out.result = _lsa_LSARADTUNREGISTERSECURITYEVENTSOURCE(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -6263,7 +6263,7 @@ static bool api_lsa_LSARADTREPORTSECURIT
 
 	r->out.result = _lsa_LSARADTREPORTSECURITYEVENT(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
--- a/source3/librpc/gen_ndr/srv_mgmt.c
+++ b/source3/librpc/gen_ndr/srv_mgmt.c
@@ -51,7 +51,7 @@ static bool api_mgmt_inq_if_ids(struct p
 
 	r->out.result = _mgmt_inq_if_ids(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -131,7 +131,7 @@ static bool api_mgmt_inq_stats(struct pi
 
 	r->out.result = _mgmt_inq_stats(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -211,7 +211,7 @@ static bool api_mgmt_is_server_listening
 
 	r->out.result = _mgmt_is_server_listening(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -284,7 +284,7 @@ static bool api_mgmt_stop_server_listeni
 
 	r->out.result = _mgmt_stop_server_listening(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -364,7 +364,7 @@ static bool api_mgmt_inq_princ_name(stru
 
 	r->out.result = _mgmt_inq_princ_name(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
--- a/source3/librpc/gen_ndr/srv_msgsvc.c
+++ b/source3/librpc/gen_ndr/srv_msgsvc.c
@@ -44,7 +44,7 @@ static bool api_NetrMessageNameAdd(struc
 
 	_NetrMessageNameAdd(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -117,7 +117,7 @@ static bool api_NetrMessageNameEnum(stru
 
 	_NetrMessageNameEnum(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -190,7 +190,7 @@ static bool api_NetrMessageNameGetInfo(s
 
 	_NetrMessageNameGetInfo(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -263,7 +263,7 @@ static bool api_NetrMessageNameDel(struc
 
 	_NetrMessageNameDel(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -361,7 +361,7 @@ static bool api_NetrSendMessage(struct p
 
 	_NetrSendMessage(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
--- a/source3/librpc/gen_ndr/srv_nbt.c
+++ b/source3/librpc/gen_ndr/srv_nbt.c
@@ -44,7 +44,7 @@ static bool api_decode_nbt_netlogon_pack
 
 	_decode_nbt_netlogon_packet(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
--- a/source3/librpc/gen_ndr/srv_netlogon.c
+++ b/source3/librpc/gen_ndr/srv_netlogon.c
@@ -51,7 +51,7 @@ static bool api_netr_LogonUasLogon(struc
 
 	r->out.result = _netr_LogonUasLogon(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -131,7 +131,7 @@ static bool api_netr_LogonUasLogoff(stru
 
 	r->out.result = _netr_LogonUasLogoff(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -218,7 +218,7 @@ static bool api_netr_LogonSamLogon(struc
 
 	r->out.result = _netr_LogonSamLogon(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -293,7 +293,7 @@ static bool api_netr_LogonSamLogoff(stru
 	r->out.return_authenticator = r->in.return_authenticator;
 	r->out.result = _netr_LogonSamLogoff(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -373,7 +373,7 @@ static bool api_netr_ServerReqChallenge(
 
 	r->out.result = _netr_ServerReqChallenge(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -453,7 +453,7 @@ static bool api_netr_ServerAuthenticate(
 
 	r->out.result = _netr_ServerAuthenticate(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -533,7 +533,7 @@ static bool api_netr_ServerPasswordSet(s
 
 	r->out.result = _netr_ServerPasswordSet(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -615,7 +615,7 @@ static bool api_netr_DatabaseDeltas(stru
 
 	r->out.result = _netr_DatabaseDeltas(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -697,7 +697,7 @@ static bool api_netr_DatabaseSync(struct
 
 	r->out.result = _netr_DatabaseSync(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -796,7 +796,7 @@ static bool api_netr_AccountDeltas(struc
 
 	r->out.result = _netr_AccountDeltas(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -896,7 +896,7 @@ static bool api_netr_AccountSync(struct
 
 	r->out.result = _netr_AccountSync(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -976,7 +976,7 @@ static bool api_netr_GetDcName(struct pi
 
 	r->out.result = _netr_GetDcName(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1056,7 +1056,7 @@ static bool api_netr_LogonControl(struct
 
 	r->out.result = _netr_LogonControl(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1136,7 +1136,7 @@ static bool api_netr_GetAnyDCName(struct
 
 	r->out.result = _netr_GetAnyDCName(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1216,7 +1216,7 @@ static bool api_netr_LogonControl2(struc
 
 	r->out.result = _netr_LogonControl2(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1297,7 +1297,7 @@ static bool api_netr_ServerAuthenticate2
 
 	r->out.result = _netr_ServerAuthenticate2(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1379,7 +1379,7 @@ static bool api_netr_DatabaseSync2(struc
 
 	r->out.result = _netr_DatabaseSync2(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1460,7 +1460,7 @@ static bool api_netr_DatabaseRedo(struct
 
 	r->out.result = _netr_DatabaseRedo(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1540,7 +1540,7 @@ static bool api_netr_LogonControl2Ex(str
 
 	r->out.result = _netr_LogonControl2Ex(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1620,7 +1620,7 @@ static bool api_netr_NetrEnumerateTruste
 
 	r->out.result = _netr_NetrEnumerateTrustedDomains(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1700,7 +1700,7 @@ static bool api_netr_DsRGetDCName(struct
 
 	r->out.result = _netr_DsRGetDCName(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1781,7 +1781,7 @@ static bool api_netr_LogonGetCapabilitie
 
 	r->out.result = _netr_LogonGetCapabilities(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1854,7 +1854,7 @@ static bool api_netr_NETRLOGONSETSERVICE
 
 	r->out.result = _netr_NETRLOGONSETSERVICEBITS(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1934,7 +1934,7 @@ static bool api_netr_LogonGetTrustRid(st
 
 	r->out.result = _netr_LogonGetTrustRid(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2007,7 +2007,7 @@ static bool api_netr_NETRLOGONCOMPUTESER
 
 	r->out.result = _netr_NETRLOGONCOMPUTESERVERDIGEST(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2080,7 +2080,7 @@ static bool api_netr_NETRLOGONCOMPUTECLI
 
 	r->out.result = _netr_NETRLOGONCOMPUTECLIENTDIGEST(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2167,7 +2167,7 @@ static bool api_netr_ServerAuthenticate3
 
 	r->out.result = _netr_ServerAuthenticate3(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2247,7 +2247,7 @@ static bool api_netr_DsRGetDCNameEx(stru
 
 	r->out.result = _netr_DsRGetDCNameEx(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2327,7 +2327,7 @@ static bool api_netr_DsRGetSiteName(stru
 
 	r->out.result = _netr_DsRGetSiteName(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2408,7 +2408,7 @@ static bool api_netr_LogonGetDomainInfo(
 
 	r->out.result = _netr_LogonGetDomainInfo(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2488,7 +2488,7 @@ static bool api_netr_ServerPasswordSet2(
 
 	r->out.result = _netr_ServerPasswordSet2(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2574,7 +2574,7 @@ static bool api_netr_ServerPasswordGet(s
 
 	r->out.result = _netr_ServerPasswordGet(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2647,7 +2647,7 @@ static bool api_netr_NETRLOGONSENDTOSAM(
 
 	r->out.result = _netr_NETRLOGONSENDTOSAM(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2727,7 +2727,7 @@ static bool api_netr_DsRAddressToSitenam
 
 	r->out.result = _netr_DsRAddressToSitenamesW(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2807,7 +2807,7 @@ static bool api_netr_DsRGetDCNameEx2(str
 
 	r->out.result = _netr_DsRGetDCNameEx2(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2880,7 +2880,7 @@ static bool api_netr_NETRLOGONGETTIMESER
 
 	r->out.result = _netr_NETRLOGONGETTIMESERVICEPARENTDOMAIN(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2960,7 +2960,7 @@ static bool api_netr_NetrEnumerateTruste
 
 	r->out.result = _netr_NetrEnumerateTrustedDomainsEx(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -3040,7 +3040,7 @@ static bool api_netr_DsRAddressToSitenam
 
 	r->out.result = _netr_DsRAddressToSitenamesExW(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -3120,7 +3120,7 @@ static bool api_netr_DsrGetDcSiteCoverag
 
 	r->out.result = _netr_DsrGetDcSiteCoverageW(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -3207,7 +3207,7 @@ static bool api_netr_LogonSamLogonEx(str
 
 	r->out.result = _netr_LogonSamLogonEx(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -3287,7 +3287,7 @@ static bool api_netr_DsrEnumerateDomainT
 
 	r->out.result = _netr_DsrEnumerateDomainTrusts(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -3360,7 +3360,7 @@ static bool api_netr_DsrDeregisterDNSHos
 
 	r->out.result = _netr_DsrDeregisterDNSHostRecords(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -3452,7 +3452,7 @@ static bool api_netr_ServerTrustPassword
 
 	r->out.result = _netr_ServerTrustPasswordsGet(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -3532,7 +3532,7 @@ static bool api_netr_DsRGetForestTrustIn
 
 	r->out.result = _netr_DsRGetForestTrustInformation(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -3618,7 +3618,7 @@ static bool api_netr_GetForestTrustInfor
 
 	r->out.result = _netr_GetForestTrustInformation(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -3706,7 +3706,7 @@ static bool api_netr_LogonSamLogonWithFl
 
 	r->out.result = _netr_LogonSamLogonWithFlags(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -3804,7 +3804,7 @@ static bool api_netr_ServerGetTrustInfo(
 
 	r->out.result = _netr_ServerGetTrustInfo(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -3877,7 +3877,7 @@ static bool api_netr_Unused47(struct pip
 
 	r->out.result = _netr_Unused47(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -3958,7 +3958,7 @@ static bool api_netr_DsrUpdateReadOnlySe
 
 	r->out.result = _netr_DsrUpdateReadOnlyServerDnsRecords(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
--- a/source3/librpc/gen_ndr/srv_ntlmssp.c
+++ b/source3/librpc/gen_ndr/srv_ntlmssp.c
@@ -44,7 +44,7 @@ static bool api_decode_NEGOTIATE_MESSAGE
 
 	_decode_NEGOTIATE_MESSAGE(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -117,7 +117,7 @@ static bool api_decode_CHALLENGE_MESSAGE
 
 	_decode_CHALLENGE_MESSAGE(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -190,7 +190,7 @@ static bool api_decode_AUTHENTICATE_MESS
 
 	_decode_AUTHENTICATE_MESSAGE(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -263,7 +263,7 @@ static bool api_decode_NTLMv2_CLIENT_CHA
 
 	_decode_NTLMv2_CLIENT_CHALLENGE(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -336,7 +336,7 @@ static bool api_decode_NTLMv2_RESPONSE(s
 
 	_decode_NTLMv2_RESPONSE(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
--- a/source3/librpc/gen_ndr/srv_ntprinting.c
+++ b/source3/librpc/gen_ndr/srv_ntprinting.c
@@ -44,7 +44,7 @@ static bool api_decode_ntprinting_form(s
 
 	_decode_ntprinting_form(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -117,7 +117,7 @@ static bool api_decode_ntprinting_driver
 
 	_decode_ntprinting_driver(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -190,7 +190,7 @@ static bool api_decode_ntprinting_printe
 
 	_decode_ntprinting_printer(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
--- a/source3/librpc/gen_ndr/srv_ntsvcs.c
+++ b/source3/librpc/gen_ndr/srv_ntsvcs.c
@@ -44,7 +44,7 @@ static bool api_PNP_Disconnect(struct pi
 
 	r->out.result = _PNP_Disconnect(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -117,7 +117,7 @@ static bool api_PNP_Connect(struct pipes
 
 	r->out.result = _PNP_Connect(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -197,7 +197,7 @@ static bool api_PNP_GetVersion(struct pi
 
 	r->out.result = _PNP_GetVersion(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -270,7 +270,7 @@ static bool api_PNP_GetGlobalState(struc
 
 	r->out.result = _PNP_GetGlobalState(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -343,7 +343,7 @@ static bool api_PNP_InitDetection(struct
 
 	r->out.result = _PNP_InitDetection(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -416,7 +416,7 @@ static bool api_PNP_ReportLogOn(struct p
 
 	r->out.result = _PNP_ReportLogOn(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -489,7 +489,7 @@ static bool api_PNP_ValidateDeviceInstan
 
 	r->out.result = _PNP_ValidateDeviceInstance(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -562,7 +562,7 @@ static bool api_PNP_GetRootDeviceInstanc
 
 	r->out.result = _PNP_GetRootDeviceInstance(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -635,7 +635,7 @@ static bool api_PNP_GetRelatedDeviceInst
 
 	r->out.result = _PNP_GetRelatedDeviceInstance(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -708,7 +708,7 @@ static bool api_PNP_EnumerateSubKeys(str
 
 	r->out.result = _PNP_EnumerateSubKeys(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -789,7 +789,7 @@ static bool api_PNP_GetDeviceList(struct
 
 	r->out.result = _PNP_GetDeviceList(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -869,7 +869,7 @@ static bool api_PNP_GetDeviceListSize(st
 
 	r->out.result = _PNP_GetDeviceListSize(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -942,7 +942,7 @@ static bool api_PNP_GetDepth(struct pipe
 
 	r->out.result = _PNP_GetDepth(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1025,7 +1025,7 @@ static bool api_PNP_GetDeviceRegProp(str
 
 	r->out.result = _PNP_GetDeviceRegProp(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1098,7 +1098,7 @@ static bool api_PNP_SetDeviceRegProp(str
 
 	r->out.result = _PNP_SetDeviceRegProp(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1171,7 +1171,7 @@ static bool api_PNP_GetClassInstance(str
 
 	r->out.result = _PNP_GetClassInstance(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1244,7 +1244,7 @@ static bool api_PNP_CreateKey(struct pip
 
 	r->out.result = _PNP_CreateKey(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1317,7 +1317,7 @@ static bool api_PNP_DeleteRegistryKey(st
 
 	r->out.result = _PNP_DeleteRegistryKey(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1390,7 +1390,7 @@ static bool api_PNP_GetClassCount(struct
 
 	r->out.result = _PNP_GetClassCount(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1463,7 +1463,7 @@ static bool api_PNP_GetClassName(struct
 
 	r->out.result = _PNP_GetClassName(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1536,7 +1536,7 @@ static bool api_PNP_DeleteClassKey(struc
 
 	r->out.result = _PNP_DeleteClassKey(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1609,7 +1609,7 @@ static bool api_PNP_GetInterfaceDeviceAl
 
 	r->out.result = _PNP_GetInterfaceDeviceAlias(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1682,7 +1682,7 @@ static bool api_PNP_GetInterfaceDeviceLi
 
 	r->out.result = _PNP_GetInterfaceDeviceList(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1755,7 +1755,7 @@ static bool api_PNP_GetInterfaceDeviceLi
 
 	r->out.result = _PNP_GetInterfaceDeviceListSize(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1828,7 +1828,7 @@ static bool api_PNP_RegisterDeviceClassA
 
 	r->out.result = _PNP_RegisterDeviceClassAssociation(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1901,7 +1901,7 @@ static bool api_PNP_UnregisterDeviceClas
 
 	r->out.result = _PNP_UnregisterDeviceClassAssociation(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1974,7 +1974,7 @@ static bool api_PNP_GetClassRegProp(stru
 
 	r->out.result = _PNP_GetClassRegProp(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2047,7 +2047,7 @@ static bool api_PNP_SetClassRegProp(stru
 
 	r->out.result = _PNP_SetClassRegProp(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2120,7 +2120,7 @@ static bool api_PNP_CreateDevInst(struct
 
 	r->out.result = _PNP_CreateDevInst(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2193,7 +2193,7 @@ static bool api_PNP_DeviceInstanceAction
 
 	r->out.result = _PNP_DeviceInstanceAction(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2266,7 +2266,7 @@ static bool api_PNP_GetDeviceStatus(stru
 
 	r->out.result = _PNP_GetDeviceStatus(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2339,7 +2339,7 @@ static bool api_PNP_SetDeviceProblem(str
 
 	r->out.result = _PNP_SetDeviceProblem(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2412,7 +2412,7 @@ static bool api_PNP_DisableDevInst(struc
 
 	r->out.result = _PNP_DisableDevInst(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2485,7 +2485,7 @@ static bool api_PNP_UninstallDevInst(str
 
 	r->out.result = _PNP_UninstallDevInst(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2558,7 +2558,7 @@ static bool api_PNP_AddID(struct pipes_s
 
 	r->out.result = _PNP_AddID(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2631,7 +2631,7 @@ static bool api_PNP_RegisterDriver(struc
 
 	r->out.result = _PNP_RegisterDriver(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2704,7 +2704,7 @@ static bool api_PNP_QueryRemove(struct p
 
 	r->out.result = _PNP_QueryRemove(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2777,7 +2777,7 @@ static bool api_PNP_RequestDeviceEject(s
 
 	r->out.result = _PNP_RequestDeviceEject(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2850,7 +2850,7 @@ static bool api_PNP_IsDockStationPresent
 
 	r->out.result = _PNP_IsDockStationPresent(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2923,7 +2923,7 @@ static bool api_PNP_RequestEjectPC(struc
 
 	r->out.result = _PNP_RequestEjectPC(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -3005,7 +3005,7 @@ static bool api_PNP_HwProfFlags(struct p
 
 	r->out.result = _PNP_HwProfFlags(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -3080,7 +3080,7 @@ static bool api_PNP_GetHwProfInfo(struct
 	r->out.info = r->in.info;
 	r->out.result = _PNP_GetHwProfInfo(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -3153,7 +3153,7 @@ static bool api_PNP_AddEmptyLogConf(stru
 
 	r->out.result = _PNP_AddEmptyLogConf(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -3226,7 +3226,7 @@ static bool api_PNP_FreeLogConf(struct p
 
 	r->out.result = _PNP_FreeLogConf(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -3299,7 +3299,7 @@ static bool api_PNP_GetFirstLogConf(stru
 
 	r->out.result = _PNP_GetFirstLogConf(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -3372,7 +3372,7 @@ static bool api_PNP_GetNextLogConf(struc
 
 	r->out.result = _PNP_GetNextLogConf(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -3445,7 +3445,7 @@ static bool api_PNP_GetLogConfPriority(s
 
 	r->out.result = _PNP_GetLogConfPriority(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -3518,7 +3518,7 @@ static bool api_PNP_AddResDes(struct pip
 
 	r->out.result = _PNP_AddResDes(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -3591,7 +3591,7 @@ static bool api_PNP_FreeResDes(struct pi
 
 	r->out.result = _PNP_FreeResDes(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -3664,7 +3664,7 @@ static bool api_PNP_GetNextResDes(struct
 
 	r->out.result = _PNP_GetNextResDes(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -3737,7 +3737,7 @@ static bool api_PNP_GetResDesData(struct
 
 	r->out.result = _PNP_GetResDesData(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -3810,7 +3810,7 @@ static bool api_PNP_GetResDesDataSize(st
 
 	r->out.result = _PNP_GetResDesDataSize(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -3883,7 +3883,7 @@ static bool api_PNP_ModifyResDes(struct
 
 	r->out.result = _PNP_ModifyResDes(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -3956,7 +3956,7 @@ static bool api_PNP_DetectResourceLimit(
 
 	r->out.result = _PNP_DetectResourceLimit(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -4029,7 +4029,7 @@ static bool api_PNP_QueryResConfList(str
 
 	r->out.result = _PNP_QueryResConfList(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -4102,7 +4102,7 @@ static bool api_PNP_SetHwProf(struct pip
 
 	r->out.result = _PNP_SetHwProf(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -4175,7 +4175,7 @@ static bool api_PNP_QueryArbitratorFreeD
 
 	r->out.result = _PNP_QueryArbitratorFreeData(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -4248,7 +4248,7 @@ static bool api_PNP_QueryArbitratorFreeS
 
 	r->out.result = _PNP_QueryArbitratorFreeSize(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -4321,7 +4321,7 @@ static bool api_PNP_RunDetection(struct
 
 	r->out.result = _PNP_RunDetection(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -4394,7 +4394,7 @@ static bool api_PNP_RegisterNotification
 
 	r->out.result = _PNP_RegisterNotification(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -4467,7 +4467,7 @@ static bool api_PNP_UnregisterNotificati
 
 	r->out.result = _PNP_UnregisterNotification(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -4540,7 +4540,7 @@ static bool api_PNP_GetCustomDevProp(str
 
 	r->out.result = _PNP_GetCustomDevProp(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -4613,7 +4613,7 @@ static bool api_PNP_GetVersionInternal(s
 
 	r->out.result = _PNP_GetVersionInternal(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -4686,7 +4686,7 @@ static bool api_PNP_GetBlockedDriverInfo
 
 	r->out.result = _PNP_GetBlockedDriverInfo(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -4759,7 +4759,7 @@ static bool api_PNP_GetServerSideDeviceI
 
 	r->out.result = _PNP_GetServerSideDeviceInstallFlags(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
--- a/source3/librpc/gen_ndr/srv_oxidresolver.c
+++ b/source3/librpc/gen_ndr/srv_oxidresolver.c
@@ -63,7 +63,7 @@ static bool api_ResolveOxid(struct pipes
 
 	r->out.result = _ResolveOxid(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -136,7 +136,7 @@ static bool api_SimplePing(struct pipes_
 
 	r->out.result = _SimplePing(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -217,7 +217,7 @@ static bool api_ComplexPing(struct pipes
 
 	r->out.result = _ComplexPing(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -290,7 +290,7 @@ static bool api_ServerAlive(struct pipes
 
 	r->out.result = _ServerAlive(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -388,7 +388,7 @@ static bool api_ResolveOxid2(struct pipe
 
 	r->out.result = _ResolveOxid2(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -492,7 +492,7 @@ static bool api_ServerAlive2(struct pipe
 
 	r->out.result = _ServerAlive2(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
--- a/source3/librpc/gen_ndr/srv_policyagent.c
+++ b/source3/librpc/gen_ndr/srv_policyagent.c
@@ -44,7 +44,7 @@ static bool api_policyagent_Dummy(struct
 
 	r->out.result = _policyagent_Dummy(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
--- a/source3/librpc/gen_ndr/srv_preg.c
+++ b/source3/librpc/gen_ndr/srv_preg.c
@@ -44,7 +44,7 @@ static bool api_decode_preg_file(struct
 
 	_decode_preg_file(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
--- a/source3/librpc/gen_ndr/srv_rap.c
+++ b/source3/librpc/gen_ndr/srv_rap.c
@@ -51,7 +51,7 @@ static bool api_rap_NetShareEnum(struct
 
 	_rap_NetShareEnum(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -125,7 +125,7 @@ static bool api_rap_NetShareAdd(struct p
 	ZERO_STRUCT(r->out);
 	_rap_NetShareAdd(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -205,7 +205,7 @@ static bool api_rap_NetServerEnum2(struc
 
 	_rap_NetServerEnum2(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -279,7 +279,7 @@ static bool api_rap_WserverGetInfo(struc
 	ZERO_STRUCT(r->out);
 	_rap_WserverGetInfo(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -359,7 +359,7 @@ static bool api_rap_NetPrintQEnum(struct
 
 	_rap_NetPrintQEnum(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -433,7 +433,7 @@ static bool api_rap_NetPrintQGetInfo(str
 	ZERO_STRUCT(r->out);
 	_rap_NetPrintQGetInfo(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -507,7 +507,7 @@ static bool api_rap_NetPrintJobPause(str
 	ZERO_STRUCT(r->out);
 	_rap_NetPrintJobPause(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -581,7 +581,7 @@ static bool api_rap_NetPrintJobContinue(
 	ZERO_STRUCT(r->out);
 	_rap_NetPrintJobContinue(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -655,7 +655,7 @@ static bool api_rap_NetPrintJobDelete(st
 	ZERO_STRUCT(r->out);
 	_rap_NetPrintJobDelete(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -729,7 +729,7 @@ static bool api_rap_NetPrintQueuePause(s
 	ZERO_STRUCT(r->out);
 	_rap_NetPrintQueuePause(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -803,7 +803,7 @@ static bool api_rap_NetPrintQueueResume(
 	ZERO_STRUCT(r->out);
 	_rap_NetPrintQueueResume(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -877,7 +877,7 @@ static bool api_rap_NetPrintQueuePurge(s
 	ZERO_STRUCT(r->out);
 	_rap_NetPrintQueuePurge(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -957,7 +957,7 @@ static bool api_rap_NetPrintJobEnum(stru
 
 	_rap_NetPrintJobEnum(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1031,7 +1031,7 @@ static bool api_rap_NetPrintJobGetInfo(s
 	ZERO_STRUCT(r->out);
 	_rap_NetPrintJobGetInfo(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1105,7 +1105,7 @@ static bool api_rap_NetPrintJobSetInfo(s
 	ZERO_STRUCT(r->out);
 	_rap_NetPrintJobSetInfo(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1185,7 +1185,7 @@ static bool api_rap_NetPrintDestEnum(str
 
 	_rap_NetPrintDestEnum(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1259,7 +1259,7 @@ static bool api_rap_NetPrintDestGetInfo(
 	ZERO_STRUCT(r->out);
 	_rap_NetPrintDestGetInfo(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1333,7 +1333,7 @@ static bool api_rap_NetUserPasswordSet2(
 	ZERO_STRUCT(r->out);
 	_rap_NetUserPasswordSet2(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1407,7 +1407,7 @@ static bool api_rap_NetOEMChangePassword
 	ZERO_STRUCT(r->out);
 	_rap_NetOEMChangePassword(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1481,7 +1481,7 @@ static bool api_rap_NetUserGetInfo(struc
 	ZERO_STRUCT(r->out);
 	_rap_NetUserGetInfo(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1561,7 +1561,7 @@ static bool api_rap_NetSessionEnum(struc
 
 	_rap_NetSessionEnum(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1635,7 +1635,7 @@ static bool api_rap_NetSessionGetInfo(st
 	ZERO_STRUCT(r->out);
 	_rap_NetSessionGetInfo(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1709,7 +1709,7 @@ static bool api_rap_NetUserAdd(struct pi
 	ZERO_STRUCT(r->out);
 	_rap_NetUserAdd(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1783,7 +1783,7 @@ static bool api_rap_NetUserDelete(struct
 	ZERO_STRUCT(r->out);
 	_rap_NetUserDelete(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1857,7 +1857,7 @@ static bool api_rap_NetRemoteTOD(struct
 	ZERO_STRUCT(r->out);
 	_rap_NetRemoteTOD(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
--- a/source3/librpc/gen_ndr/srv_remact.c
+++ b/source3/librpc/gen_ndr/srv_remact.c
@@ -99,7 +99,7 @@ static bool api_RemoteActivation(struct
 
 	r->out.result = _RemoteActivation(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
--- a/source3/librpc/gen_ndr/srv_rot.c
+++ b/source3/librpc/gen_ndr/srv_rot.c
@@ -51,7 +51,7 @@ static bool api_rot_add(struct pipes_str
 
 	r->out.result = _rot_add(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -124,7 +124,7 @@ static bool api_rot_remove(struct pipes_
 
 	r->out.result = _rot_remove(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -197,7 +197,7 @@ static bool api_rot_is_listed(struct pip
 
 	r->out.result = _rot_is_listed(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -277,7 +277,7 @@ static bool api_rot_get_interface_pointe
 
 	r->out.result = _rot_get_interface_pointer(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -350,7 +350,7 @@ static bool api_rot_set_modification_tim
 
 	r->out.result = _rot_set_modification_time(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -430,7 +430,7 @@ static bool api_rot_get_modification_tim
 
 	r->out.result = _rot_get_modification_time(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -510,7 +510,7 @@ static bool api_rot_enum(struct pipes_st
 
 	r->out.result = _rot_enum(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
--- a/source3/librpc/gen_ndr/srv_samr.c
+++ b/source3/librpc/gen_ndr/srv_samr.c
@@ -51,7 +51,7 @@ static bool api_samr_Connect(struct pipe
 
 	r->out.result = _samr_Connect(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -126,7 +126,7 @@ static bool api_samr_Close(struct pipes_
 	r->out.handle = r->in.handle;
 	r->out.result = _samr_Close(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -199,7 +199,7 @@ static bool api_samr_SetSecurity(struct
 
 	r->out.result = _samr_SetSecurity(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -279,7 +279,7 @@ static bool api_samr_QuerySecurity(struc
 
 	r->out.result = _samr_QuerySecurity(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -352,7 +352,7 @@ static bool api_samr_Shutdown(struct pip
 
 	r->out.result = _samr_Shutdown(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -432,7 +432,7 @@ static bool api_samr_LookupDomain(struct
 
 	r->out.result = _samr_LookupDomain(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -519,7 +519,7 @@ static bool api_samr_EnumDomains(struct
 
 	r->out.result = _samr_EnumDomains(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -599,7 +599,7 @@ static bool api_samr_OpenDomain(struct p
 
 	r->out.result = _samr_OpenDomain(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -679,7 +679,7 @@ static bool api_samr_QueryDomainInfo(str
 
 	r->out.result = _samr_QueryDomainInfo(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -752,7 +752,7 @@ static bool api_samr_SetDomainInfo(struc
 
 	r->out.result = _samr_SetDomainInfo(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -838,7 +838,7 @@ static bool api_samr_CreateDomainGroup(s
 
 	r->out.result = _samr_CreateDomainGroup(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -925,7 +925,7 @@ static bool api_samr_EnumDomainGroups(st
 
 	r->out.result = _samr_EnumDomainGroups(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1011,7 +1011,7 @@ static bool api_samr_CreateUser(struct p
 
 	r->out.result = _samr_CreateUser(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1098,7 +1098,7 @@ static bool api_samr_EnumDomainUsers(str
 
 	r->out.result = _samr_EnumDomainUsers(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1184,7 +1184,7 @@ static bool api_samr_CreateDomAlias(stru
 
 	r->out.result = _samr_CreateDomAlias(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1271,7 +1271,7 @@ static bool api_samr_EnumDomainAliases(s
 
 	r->out.result = _samr_EnumDomainAliases(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1351,7 +1351,7 @@ static bool api_samr_GetAliasMembership(
 
 	r->out.result = _samr_GetAliasMembership(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1437,7 +1437,7 @@ static bool api_samr_LookupNames(struct
 
 	r->out.result = _samr_LookupNames(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1523,7 +1523,7 @@ static bool api_samr_LookupRids(struct p
 
 	r->out.result = _samr_LookupRids(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1603,7 +1603,7 @@ static bool api_samr_OpenGroup(struct pi
 
 	r->out.result = _samr_OpenGroup(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1683,7 +1683,7 @@ static bool api_samr_QueryGroupInfo(stru
 
 	r->out.result = _samr_QueryGroupInfo(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1756,7 +1756,7 @@ static bool api_samr_SetGroupInfo(struct
 
 	r->out.result = _samr_SetGroupInfo(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1829,7 +1829,7 @@ static bool api_samr_AddGroupMember(stru
 
 	r->out.result = _samr_AddGroupMember(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1904,7 +1904,7 @@ static bool api_samr_DeleteDomainGroup(s
 	r->out.group_handle = r->in.group_handle;
 	r->out.result = _samr_DeleteDomainGroup(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1977,7 +1977,7 @@ static bool api_samr_DeleteGroupMember(s
 
 	r->out.result = _samr_DeleteGroupMember(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2057,7 +2057,7 @@ static bool api_samr_QueryGroupMember(st
 
 	r->out.result = _samr_QueryGroupMember(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2130,7 +2130,7 @@ static bool api_samr_SetMemberAttributes
 
 	r->out.result = _samr_SetMemberAttributesOfGroup(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2210,7 +2210,7 @@ static bool api_samr_OpenAlias(struct pi
 
 	r->out.result = _samr_OpenAlias(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2290,7 +2290,7 @@ static bool api_samr_QueryAliasInfo(stru
 
 	r->out.result = _samr_QueryAliasInfo(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2363,7 +2363,7 @@ static bool api_samr_SetAliasInfo(struct
 
 	r->out.result = _samr_SetAliasInfo(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2438,7 +2438,7 @@ static bool api_samr_DeleteDomAlias(stru
 	r->out.alias_handle = r->in.alias_handle;
 	r->out.result = _samr_DeleteDomAlias(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2511,7 +2511,7 @@ static bool api_samr_AddAliasMember(stru
 
 	r->out.result = _samr_AddAliasMember(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2584,7 +2584,7 @@ static bool api_samr_DeleteAliasMember(s
 
 	r->out.result = _samr_DeleteAliasMember(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2664,7 +2664,7 @@ static bool api_samr_GetMembersInAlias(s
 
 	r->out.result = _samr_GetMembersInAlias(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2744,7 +2744,7 @@ static bool api_samr_OpenUser(struct pip
 
 	r->out.result = _samr_OpenUser(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2819,7 +2819,7 @@ static bool api_samr_DeleteUser(struct p
 	r->out.user_handle = r->in.user_handle;
 	r->out.result = _samr_DeleteUser(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2899,7 +2899,7 @@ static bool api_samr_QueryUserInfo(struc
 
 	r->out.result = _samr_QueryUserInfo(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2972,7 +2972,7 @@ static bool api_samr_SetUserInfo(struct
 
 	r->out.result = _samr_SetUserInfo(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -3045,7 +3045,7 @@ static bool api_samr_ChangePasswordUser(
 
 	r->out.result = _samr_ChangePasswordUser(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -3125,7 +3125,7 @@ static bool api_samr_GetGroupsForUser(st
 
 	r->out.result = _samr_GetGroupsForUser(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -3217,7 +3217,7 @@ static bool api_samr_QueryDisplayInfo(st
 
 	r->out.result = _samr_QueryDisplayInfo(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -3297,7 +3297,7 @@ static bool api_samr_GetDisplayEnumerati
 
 	r->out.result = _samr_GetDisplayEnumerationIndex(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -3370,7 +3370,7 @@ static bool api_samr_TestPrivateFunction
 
 	r->out.result = _samr_TestPrivateFunctionsDomain(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -3443,7 +3443,7 @@ static bool api_samr_TestPrivateFunction
 
 	r->out.result = _samr_TestPrivateFunctionsUser(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -3523,7 +3523,7 @@ static bool api_samr_GetUserPwInfo(struc
 
 	r->out.result = _samr_GetUserPwInfo(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -3596,7 +3596,7 @@ static bool api_samr_RemoveMemberFromFor
 
 	r->out.result = _samr_RemoveMemberFromForeignDomain(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -3676,7 +3676,7 @@ static bool api_samr_QueryDomainInfo2(st
 
 	r->out.result = _samr_QueryDomainInfo2(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -3756,7 +3756,7 @@ static bool api_samr_QueryUserInfo2(stru
 
 	r->out.result = _samr_QueryUserInfo2(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -3848,7 +3848,7 @@ static bool api_samr_QueryDisplayInfo2(s
 
 	r->out.result = _samr_QueryDisplayInfo2(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -3928,7 +3928,7 @@ static bool api_samr_GetDisplayEnumerati
 
 	r->out.result = _samr_GetDisplayEnumerationIndex2(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -4020,7 +4020,7 @@ static bool api_samr_CreateUser2(struct
 
 	r->out.result = _samr_CreateUser2(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -4112,7 +4112,7 @@ static bool api_samr_QueryDisplayInfo3(s
 
 	r->out.result = _samr_QueryDisplayInfo3(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -4185,7 +4185,7 @@ static bool api_samr_AddMultipleMembersT
 
 	r->out.result = _samr_AddMultipleMembersToAlias(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -4258,7 +4258,7 @@ static bool api_samr_RemoveMultipleMembe
 
 	r->out.result = _samr_RemoveMultipleMembersFromAlias(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -4331,7 +4331,7 @@ static bool api_samr_OemChangePasswordUs
 
 	r->out.result = _samr_OemChangePasswordUser2(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -4404,7 +4404,7 @@ static bool api_samr_ChangePasswordUser2
 
 	r->out.result = _samr_ChangePasswordUser2(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -4484,7 +4484,7 @@ static bool api_samr_GetDomPwInfo(struct
 
 	r->out.result = _samr_GetDomPwInfo(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -4564,7 +4564,7 @@ static bool api_samr_Connect2(struct pip
 
 	r->out.result = _samr_Connect2(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -4637,7 +4637,7 @@ static bool api_samr_SetUserInfo2(struct
 
 	r->out.result = _samr_SetUserInfo2(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -4710,7 +4710,7 @@ static bool api_samr_SetBootKeyInformati
 
 	r->out.result = _samr_SetBootKeyInformation(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -4790,7 +4790,7 @@ static bool api_samr_GetBootKeyInformati
 
 	r->out.result = _samr_GetBootKeyInformation(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -4870,7 +4870,7 @@ static bool api_samr_Connect3(struct pip
 
 	r->out.result = _samr_Connect3(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -4950,7 +4950,7 @@ static bool api_samr_Connect4(struct pip
 
 	r->out.result = _samr_Connect4(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -5036,7 +5036,7 @@ static bool api_samr_ChangePasswordUser3
 
 	r->out.result = _samr_ChangePasswordUser3(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -5128,7 +5128,7 @@ static bool api_samr_Connect5(struct pip
 
 	r->out.result = _samr_Connect5(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -5208,7 +5208,7 @@ static bool api_samr_RidToSid(struct pip
 
 	r->out.result = _samr_RidToSid(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -5281,7 +5281,7 @@ static bool api_samr_SetDsrmPassword(str
 
 	r->out.result = _samr_SetDsrmPassword(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -5361,7 +5361,7 @@ static bool api_samr_ValidatePassword(st
 
 	r->out.result = _samr_ValidatePassword(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
--- a/source3/librpc/gen_ndr/srv_scerpc.c
+++ b/source3/librpc/gen_ndr/srv_scerpc.c
@@ -44,7 +44,7 @@ static bool api_scerpc_Unknown0(struct p
 
 	r->out.result = _scerpc_Unknown0(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
--- a/source3/librpc/gen_ndr/srv_spoolss.c
+++ b/source3/librpc/gen_ndr/srv_spoolss.c
@@ -63,7 +63,7 @@ static bool api_spoolss_EnumPrinters(str
 
 	r->out.result = _spoolss_EnumPrinters(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -143,7 +143,7 @@ static bool api_spoolss_OpenPrinter(stru
 
 	r->out.result = _spoolss_OpenPrinter(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -216,7 +216,7 @@ static bool api_spoolss_SetJob(struct pi
 
 	r->out.result = _spoolss_SetJob(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -302,7 +302,7 @@ static bool api_spoolss_GetJob(struct pi
 
 	r->out.result = _spoolss_GetJob(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -394,7 +394,7 @@ static bool api_spoolss_EnumJobs(struct
 
 	r->out.result = _spoolss_EnumJobs(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -474,7 +474,7 @@ static bool api_spoolss_AddPrinter(struc
 
 	r->out.result = _spoolss_AddPrinter(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -547,7 +547,7 @@ static bool api_spoolss_DeletePrinter(st
 
 	r->out.result = _spoolss_DeletePrinter(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -620,7 +620,7 @@ static bool api_spoolss_SetPrinter(struc
 
 	r->out.result = _spoolss_SetPrinter(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -706,7 +706,7 @@ static bool api_spoolss_GetPrinter(struc
 
 	r->out.result = _spoolss_GetPrinter(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -779,7 +779,7 @@ static bool api_spoolss_AddPrinterDriver
 
 	r->out.result = _spoolss_AddPrinterDriver(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -871,7 +871,7 @@ static bool api_spoolss_EnumPrinterDrive
 
 	r->out.result = _spoolss_EnumPrinterDrivers(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -957,7 +957,7 @@ static bool api_spoolss_GetPrinterDriver
 
 	r->out.result = _spoolss_GetPrinterDriver(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1043,7 +1043,7 @@ static bool api_spoolss_GetPrinterDriver
 
 	r->out.result = _spoolss_GetPrinterDriverDirectory(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1116,7 +1116,7 @@ static bool api_spoolss_DeletePrinterDri
 
 	r->out.result = _spoolss_DeletePrinterDriver(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1189,7 +1189,7 @@ static bool api_spoolss_AddPrintProcesso
 
 	r->out.result = _spoolss_AddPrintProcessor(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1281,7 +1281,7 @@ static bool api_spoolss_EnumPrintProcess
 
 	r->out.result = _spoolss_EnumPrintProcessors(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1367,7 +1367,7 @@ static bool api_spoolss_GetPrintProcesso
 
 	r->out.result = _spoolss_GetPrintProcessorDirectory(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1447,7 +1447,7 @@ static bool api_spoolss_StartDocPrinter(
 
 	r->out.result = _spoolss_StartDocPrinter(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1520,7 +1520,7 @@ static bool api_spoolss_StartPagePrinter
 
 	r->out.result = _spoolss_StartPagePrinter(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1600,7 +1600,7 @@ static bool api_spoolss_WritePrinter(str
 
 	r->out.result = _spoolss_WritePrinter(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1673,7 +1673,7 @@ static bool api_spoolss_EndPagePrinter(s
 
 	r->out.result = _spoolss_EndPagePrinter(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1746,7 +1746,7 @@ static bool api_spoolss_AbortPrinter(str
 
 	r->out.result = _spoolss_AbortPrinter(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1832,7 +1832,7 @@ static bool api_spoolss_ReadPrinter(stru
 
 	r->out.result = _spoolss_ReadPrinter(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1905,7 +1905,7 @@ static bool api_spoolss_EndDocPrinter(st
 
 	r->out.result = _spoolss_EndDocPrinter(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1986,7 +1986,7 @@ static bool api_spoolss_AddJob(struct pi
 
 	r->out.result = _spoolss_AddJob(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2059,7 +2059,7 @@ static bool api_spoolss_ScheduleJob(stru
 
 	r->out.result = _spoolss_ScheduleJob(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2151,7 +2151,7 @@ static bool api_spoolss_GetPrinterData(s
 
 	r->out.result = _spoolss_GetPrinterData(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2224,7 +2224,7 @@ static bool api_spoolss_SetPrinterData(s
 
 	r->out.result = _spoolss_SetPrinterData(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2297,7 +2297,7 @@ static bool api_spoolss_WaitForPrinterCh
 
 	r->out.result = _spoolss_WaitForPrinterChange(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2372,7 +2372,7 @@ static bool api_spoolss_ClosePrinter(str
 	r->out.handle = r->in.handle;
 	r->out.result = _spoolss_ClosePrinter(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2445,7 +2445,7 @@ static bool api_spoolss_AddForm(struct p
 
 	r->out.result = _spoolss_AddForm(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2518,7 +2518,7 @@ static bool api_spoolss_DeleteForm(struc
 
 	r->out.result = _spoolss_DeleteForm(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2604,7 +2604,7 @@ static bool api_spoolss_GetForm(struct p
 
 	r->out.result = _spoolss_GetForm(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2677,7 +2677,7 @@ static bool api_spoolss_SetForm(struct p
 
 	r->out.result = _spoolss_SetForm(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2769,7 +2769,7 @@ static bool api_spoolss_EnumForms(struct
 
 	r->out.result = _spoolss_EnumForms(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2861,7 +2861,7 @@ static bool api_spoolss_EnumPorts(struct
 
 	r->out.result = _spoolss_EnumPorts(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2953,7 +2953,7 @@ static bool api_spoolss_EnumMonitors(str
 
 	r->out.result = _spoolss_EnumMonitors(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -3026,7 +3026,7 @@ static bool api_spoolss_AddPort(struct p
 
 	r->out.result = _spoolss_AddPort(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -3099,7 +3099,7 @@ static bool api_spoolss_ConfigurePort(st
 
 	r->out.result = _spoolss_ConfigurePort(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -3172,7 +3172,7 @@ static bool api_spoolss_DeletePort(struc
 
 	r->out.result = _spoolss_DeletePort(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -3252,7 +3252,7 @@ static bool api_spoolss_CreatePrinterIC(
 
 	r->out.result = _spoolss_CreatePrinterIC(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -3325,7 +3325,7 @@ static bool api_spoolss_PlayGDIScriptOnP
 
 	r->out.result = _spoolss_PlayGDIScriptOnPrinterIC(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -3400,7 +3400,7 @@ static bool api_spoolss_DeletePrinterIC(
 	r->out.gdi_handle = r->in.gdi_handle;
 	r->out.result = _spoolss_DeletePrinterIC(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -3473,7 +3473,7 @@ static bool api_spoolss_AddPrinterConnec
 
 	r->out.result = _spoolss_AddPrinterConnection(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -3546,7 +3546,7 @@ static bool api_spoolss_DeletePrinterCon
 
 	r->out.result = _spoolss_DeletePrinterConnection(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -3619,7 +3619,7 @@ static bool api_spoolss_PrinterMessageBo
 
 	r->out.result = _spoolss_PrinterMessageBox(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -3692,7 +3692,7 @@ static bool api_spoolss_AddMonitor(struc
 
 	r->out.result = _spoolss_AddMonitor(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -3765,7 +3765,7 @@ static bool api_spoolss_DeleteMonitor(st
 
 	r->out.result = _spoolss_DeleteMonitor(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -3838,7 +3838,7 @@ static bool api_spoolss_DeletePrintProce
 
 	r->out.result = _spoolss_DeletePrintProcessor(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -3911,7 +3911,7 @@ static bool api_spoolss_AddPrintProvidor
 
 	r->out.result = _spoolss_AddPrintProvidor(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -3984,7 +3984,7 @@ static bool api_spoolss_DeletePrintProvi
 
 	r->out.result = _spoolss_DeletePrintProvidor(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -4076,7 +4076,7 @@ static bool api_spoolss_EnumPrintProcDat
 
 	r->out.result = _spoolss_EnumPrintProcDataTypes(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -4149,7 +4149,7 @@ static bool api_spoolss_ResetPrinter(str
 
 	r->out.result = _spoolss_ResetPrinter(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -4247,7 +4247,7 @@ static bool api_spoolss_GetPrinterDriver
 
 	r->out.result = _spoolss_GetPrinterDriver2(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -4320,7 +4320,7 @@ static bool api_spoolss_FindFirstPrinter
 
 	r->out.result = _spoolss_FindFirstPrinterChangeNotification(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -4393,7 +4393,7 @@ static bool api_spoolss_FindNextPrinterC
 
 	r->out.result = _spoolss_FindNextPrinterChangeNotification(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -4466,7 +4466,7 @@ static bool api_spoolss_FindClosePrinter
 
 	r->out.result = _spoolss_FindClosePrinterNotify(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -4539,7 +4539,7 @@ static bool api_spoolss_RouterFindFirstP
 
 	r->out.result = _spoolss_RouterFindFirstPrinterChangeNotificationOld(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -4619,7 +4619,7 @@ static bool api_spoolss_ReplyOpenPrinter
 
 	r->out.result = _spoolss_ReplyOpenPrinter(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -4692,7 +4692,7 @@ static bool api_spoolss_RouterReplyPrint
 
 	r->out.result = _spoolss_RouterReplyPrinter(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -4767,7 +4767,7 @@ static bool api_spoolss_ReplyClosePrinte
 	r->out.handle = r->in.handle;
 	r->out.result = _spoolss_ReplyClosePrinter(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -4840,7 +4840,7 @@ static bool api_spoolss_AddPortEx(struct
 
 	r->out.result = _spoolss_AddPortEx(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -4913,7 +4913,7 @@ static bool api_spoolss_RouterFindFirstP
 
 	r->out.result = _spoolss_RouterFindFirstPrinterChangeNotification(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -4986,7 +4986,7 @@ static bool api_spoolss_SpoolerInit(stru
 
 	r->out.result = _spoolss_SpoolerInit(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -5059,7 +5059,7 @@ static bool api_spoolss_ResetPrinterEx(s
 
 	r->out.result = _spoolss_ResetPrinterEx(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -5132,7 +5132,7 @@ static bool api_spoolss_RemoteFindFirstP
 
 	r->out.result = _spoolss_RemoteFindFirstPrinterChangeNotifyEx(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -5212,7 +5212,7 @@ static bool api_spoolss_RouterReplyPrint
 
 	r->out.result = _spoolss_RouterReplyPrinterEx(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -5292,7 +5292,7 @@ static bool api_spoolss_RouterRefreshPri
 
 	r->out.result = _spoolss_RouterRefreshPrinterChangeNotify(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -5365,7 +5365,7 @@ static bool api_spoolss_44(struct pipes_
 
 	r->out.result = _spoolss_44(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -5445,7 +5445,7 @@ static bool api_spoolss_OpenPrinterEx(st
 
 	r->out.result = _spoolss_OpenPrinterEx(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -5525,7 +5525,7 @@ static bool api_spoolss_AddPrinterEx(str
 
 	r->out.result = _spoolss_AddPrinterEx(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -5598,7 +5598,7 @@ static bool api_spoolss_SetPort(struct p
 
 	r->out.result = _spoolss_SetPort(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -5702,7 +5702,7 @@ static bool api_spoolss_EnumPrinterData(
 
 	r->out.result = _spoolss_EnumPrinterData(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -5775,7 +5775,7 @@ static bool api_spoolss_DeletePrinterDat
 
 	r->out.result = _spoolss_DeletePrinterData(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -5848,7 +5848,7 @@ static bool api_spoolss_4a(struct pipes_
 
 	r->out.result = _spoolss_4a(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -5921,7 +5921,7 @@ static bool api_spoolss_4b(struct pipes_
 
 	r->out.result = _spoolss_4b(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -5994,7 +5994,7 @@ static bool api_spoolss_4c(struct pipes_
 
 	r->out.result = _spoolss_4c(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -6067,7 +6067,7 @@ static bool api_spoolss_SetPrinterDataEx
 
 	r->out.result = _spoolss_SetPrinterDataEx(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -6159,7 +6159,7 @@ static bool api_spoolss_GetPrinterDataEx
 
 	r->out.result = _spoolss_GetPrinterDataEx(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -6251,7 +6251,7 @@ static bool api_spoolss_EnumPrinterDataE
 
 	r->out.result = _spoolss_EnumPrinterDataEx(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -6343,7 +6343,7 @@ static bool api_spoolss_EnumPrinterKey(s
 
 	r->out.result = _spoolss_EnumPrinterKey(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -6416,7 +6416,7 @@ static bool api_spoolss_DeletePrinterDat
 
 	r->out.result = _spoolss_DeletePrinterDataEx(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -6489,7 +6489,7 @@ static bool api_spoolss_DeletePrinterKey
 
 	r->out.result = _spoolss_DeletePrinterKey(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -6562,7 +6562,7 @@ static bool api_spoolss_53(struct pipes_
 
 	r->out.result = _spoolss_53(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -6635,7 +6635,7 @@ static bool api_spoolss_DeletePrinterDri
 
 	r->out.result = _spoolss_DeletePrinterDriverEx(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -6708,7 +6708,7 @@ static bool api_spoolss_AddPerMachineCon
 
 	r->out.result = _spoolss_AddPerMachineConnection(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -6781,7 +6781,7 @@ static bool api_spoolss_DeletePerMachine
 
 	r->out.result = _spoolss_DeletePerMachineConnection(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -6854,7 +6854,7 @@ static bool api_spoolss_EnumPerMachineCo
 
 	r->out.result = _spoolss_EnumPerMachineConnections(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -6941,7 +6941,7 @@ static bool api_spoolss_XcvData(struct p
 
 	r->out.result = _spoolss_XcvData(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -7014,7 +7014,7 @@ static bool api_spoolss_AddPrinterDriver
 
 	r->out.result = _spoolss_AddPrinterDriverEx(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -7087,7 +7087,7 @@ static bool api_spoolss_5a(struct pipes_
 
 	r->out.result = _spoolss_5a(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -7160,7 +7160,7 @@ static bool api_spoolss_5b(struct pipes_
 
 	r->out.result = _spoolss_5b(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -7233,7 +7233,7 @@ static bool api_spoolss_5c(struct pipes_
 
 	r->out.result = _spoolss_5c(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -7306,7 +7306,7 @@ static bool api_spoolss_5d(struct pipes_
 
 	r->out.result = _spoolss_5d(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -7379,7 +7379,7 @@ static bool api_spoolss_5e(struct pipes_
 
 	r->out.result = _spoolss_5e(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -7452,7 +7452,7 @@ static bool api_spoolss_5f(struct pipes_
 
 	r->out.result = _spoolss_5f(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -7525,7 +7525,7 @@ static bool api_spoolss_60(struct pipes_
 
 	r->out.result = _spoolss_60(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -7598,7 +7598,7 @@ static bool api_spoolss_61(struct pipes_
 
 	r->out.result = _spoolss_61(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -7671,7 +7671,7 @@ static bool api_spoolss_62(struct pipes_
 
 	r->out.result = _spoolss_62(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -7744,7 +7744,7 @@ static bool api_spoolss_63(struct pipes_
 
 	r->out.result = _spoolss_63(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -7817,7 +7817,7 @@ static bool api_spoolss_64(struct pipes_
 
 	r->out.result = _spoolss_64(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -7890,7 +7890,7 @@ static bool api_spoolss_65(struct pipes_
 
 	r->out.result = _spoolss_65(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -7970,7 +7970,7 @@ static bool api_spoolss_GetCorePrinterDr
 
 	r->out.result = _spoolss_GetCorePrinterDrivers(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -8043,7 +8043,7 @@ static bool api_spoolss_67(struct pipes_
 
 	r->out.result = _spoolss_67(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -8124,7 +8124,7 @@ static bool api_spoolss_GetPrinterDriver
 
 	r->out.result = _spoolss_GetPrinterDriverPackagePath(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -8197,7 +8197,7 @@ static bool api_spoolss_69(struct pipes_
 
 	r->out.result = _spoolss_69(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -8270,7 +8270,7 @@ static bool api_spoolss_6a(struct pipes_
 
 	r->out.result = _spoolss_6a(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -8343,7 +8343,7 @@ static bool api_spoolss_6b(struct pipes_
 
 	r->out.result = _spoolss_6b(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -8416,7 +8416,7 @@ static bool api_spoolss_6c(struct pipes_
 
 	r->out.result = _spoolss_6c(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -8489,7 +8489,7 @@ static bool api_spoolss_6d(struct pipes_
 
 	r->out.result = _spoolss_6d(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
--- a/source3/librpc/gen_ndr/srv_srvsvc.c
+++ b/source3/librpc/gen_ndr/srv_srvsvc.c
@@ -53,7 +53,7 @@ static bool api_srvsvc_NetCharDevEnum(st
 
 	r->out.result = _srvsvc_NetCharDevEnum(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -133,7 +133,7 @@ static bool api_srvsvc_NetCharDevGetInfo
 
 	r->out.result = _srvsvc_NetCharDevGetInfo(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -206,7 +206,7 @@ static bool api_srvsvc_NetCharDevControl
 
 	r->out.result = _srvsvc_NetCharDevControl(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -288,7 +288,7 @@ static bool api_srvsvc_NetCharDevQEnum(s
 
 	r->out.result = _srvsvc_NetCharDevQEnum(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -368,7 +368,7 @@ static bool api_srvsvc_NetCharDevQGetInf
 
 	r->out.result = _srvsvc_NetCharDevQGetInfo(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -443,7 +443,7 @@ static bool api_srvsvc_NetCharDevQSetInf
 	r->out.parm_error = r->in.parm_error;
 	r->out.result = _srvsvc_NetCharDevQSetInfo(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -516,7 +516,7 @@ static bool api_srvsvc_NetCharDevQPurge(
 
 	r->out.result = _srvsvc_NetCharDevQPurge(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -589,7 +589,7 @@ static bool api_srvsvc_NetCharDevQPurgeS
 
 	r->out.result = _srvsvc_NetCharDevQPurgeSelf(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -671,7 +671,7 @@ static bool api_srvsvc_NetConnEnum(struc
 
 	r->out.result = _srvsvc_NetConnEnum(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -753,7 +753,7 @@ static bool api_srvsvc_NetFileEnum(struc
 
 	r->out.result = _srvsvc_NetFileEnum(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -833,7 +833,7 @@ static bool api_srvsvc_NetFileGetInfo(st
 
 	r->out.result = _srvsvc_NetFileGetInfo(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -906,7 +906,7 @@ static bool api_srvsvc_NetFileClose(stru
 
 	r->out.result = _srvsvc_NetFileClose(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -988,7 +988,7 @@ static bool api_srvsvc_NetSessEnum(struc
 
 	r->out.result = _srvsvc_NetSessEnum(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1061,7 +1061,7 @@ static bool api_srvsvc_NetSessDel(struct
 
 	r->out.result = _srvsvc_NetSessDel(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1136,7 +1136,7 @@ static bool api_srvsvc_NetShareAdd(struc
 	r->out.parm_error = r->in.parm_error;
 	r->out.result = _srvsvc_NetShareAdd(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1218,7 +1218,7 @@ static bool api_srvsvc_NetShareEnumAll(s
 
 	r->out.result = _srvsvc_NetShareEnumAll(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1298,7 +1298,7 @@ static bool api_srvsvc_NetShareGetInfo(s
 
 	r->out.result = _srvsvc_NetShareGetInfo(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1373,7 +1373,7 @@ static bool api_srvsvc_NetShareSetInfo(s
 	r->out.parm_error = r->in.parm_error;
 	r->out.result = _srvsvc_NetShareSetInfo(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1446,7 +1446,7 @@ static bool api_srvsvc_NetShareDel(struc
 
 	r->out.result = _srvsvc_NetShareDel(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1519,7 +1519,7 @@ static bool api_srvsvc_NetShareDelSticky
 
 	r->out.result = _srvsvc_NetShareDelSticky(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1599,7 +1599,7 @@ static bool api_srvsvc_NetShareCheck(str
 
 	r->out.result = _srvsvc_NetShareCheck(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1679,7 +1679,7 @@ static bool api_srvsvc_NetSrvGetInfo(str
 
 	r->out.result = _srvsvc_NetSrvGetInfo(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1754,7 +1754,7 @@ static bool api_srvsvc_NetSrvSetInfo(str
 	r->out.parm_error = r->in.parm_error;
 	r->out.result = _srvsvc_NetSrvSetInfo(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1836,7 +1836,7 @@ static bool api_srvsvc_NetDiskEnum(struc
 
 	r->out.result = _srvsvc_NetDiskEnum(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1916,7 +1916,7 @@ static bool api_srvsvc_NetServerStatisti
 
 	r->out.result = _srvsvc_NetServerStatisticsGet(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1989,7 +1989,7 @@ static bool api_srvsvc_NetTransportAdd(s
 
 	r->out.result = _srvsvc_NetTransportAdd(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2071,7 +2071,7 @@ static bool api_srvsvc_NetTransportEnum(
 
 	r->out.result = _srvsvc_NetTransportEnum(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2144,7 +2144,7 @@ static bool api_srvsvc_NetTransportDel(s
 
 	r->out.result = _srvsvc_NetTransportDel(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2224,7 +2224,7 @@ static bool api_srvsvc_NetRemoteTOD(stru
 
 	r->out.result = _srvsvc_NetRemoteTOD(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2297,7 +2297,7 @@ static bool api_srvsvc_NetSetServiceBits
 
 	r->out.result = _srvsvc_NetSetServiceBits(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2377,7 +2377,7 @@ static bool api_srvsvc_NetPathType(struc
 
 	r->out.result = _srvsvc_NetPathType(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2458,7 +2458,7 @@ static bool api_srvsvc_NetPathCanonicali
 
 	r->out.result = _srvsvc_NetPathCanonicalize(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2531,7 +2531,7 @@ static bool api_srvsvc_NetPathCompare(st
 
 	r->out.result = _srvsvc_NetPathCompare(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2604,7 +2604,7 @@ static bool api_srvsvc_NetNameValidate(s
 
 	r->out.result = _srvsvc_NetNameValidate(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2677,7 +2677,7 @@ static bool api_srvsvc_NETRPRNAMECANONIC
 
 	r->out.result = _srvsvc_NETRPRNAMECANONICALIZE(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2750,7 +2750,7 @@ static bool api_srvsvc_NetPRNameCompare(
 
 	r->out.result = _srvsvc_NetPRNameCompare(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2832,7 +2832,7 @@ static bool api_srvsvc_NetShareEnum(stru
 
 	r->out.result = _srvsvc_NetShareEnum(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2912,7 +2912,7 @@ static bool api_srvsvc_NetShareDelStart(
 
 	r->out.result = _srvsvc_NetShareDelStart(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2987,7 +2987,7 @@ static bool api_srvsvc_NetShareDelCommit
 	r->out.hnd = r->in.hnd;
 	r->out.result = _srvsvc_NetShareDelCommit(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -3067,7 +3067,7 @@ static bool api_srvsvc_NetGetFileSecurit
 
 	r->out.result = _srvsvc_NetGetFileSecurity(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -3140,7 +3140,7 @@ static bool api_srvsvc_NetSetFileSecurit
 
 	r->out.result = _srvsvc_NetSetFileSecurity(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -3213,7 +3213,7 @@ static bool api_srvsvc_NetServerTranspor
 
 	r->out.result = _srvsvc_NetServerTransportAddEx(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -3286,7 +3286,7 @@ static bool api_srvsvc_NetServerSetServi
 
 	r->out.result = _srvsvc_NetServerSetServiceBitsEx(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -3359,7 +3359,7 @@ static bool api_srvsvc_NETRDFSGETVERSION
 
 	r->out.result = _srvsvc_NETRDFSGETVERSION(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -3432,7 +3432,7 @@ static bool api_srvsvc_NETRDFSCREATELOCA
 
 	r->out.result = _srvsvc_NETRDFSCREATELOCALPARTITION(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -3505,7 +3505,7 @@ static bool api_srvsvc_NETRDFSDELETELOCA
 
 	r->out.result = _srvsvc_NETRDFSDELETELOCALPARTITION(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -3578,7 +3578,7 @@ static bool api_srvsvc_NETRDFSSETLOCALVO
 
 	r->out.result = _srvsvc_NETRDFSSETLOCALVOLUMESTATE(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -3651,7 +3651,7 @@ static bool api_srvsvc_NETRDFSSETSERVERI
 
 	r->out.result = _srvsvc_NETRDFSSETSERVERINFO(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -3724,7 +3724,7 @@ static bool api_srvsvc_NETRDFSCREATEEXIT
 
 	r->out.result = _srvsvc_NETRDFSCREATEEXITPOINT(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -3797,7 +3797,7 @@ static bool api_srvsvc_NETRDFSDELETEEXIT
 
 	r->out.result = _srvsvc_NETRDFSDELETEEXITPOINT(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -3870,7 +3870,7 @@ static bool api_srvsvc_NETRDFSMODIFYPREF
 
 	r->out.result = _srvsvc_NETRDFSMODIFYPREFIX(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -3943,7 +3943,7 @@ static bool api_srvsvc_NETRDFSFIXLOCALVO
 
 	r->out.result = _srvsvc_NETRDFSFIXLOCALVOLUME(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -4016,7 +4016,7 @@ static bool api_srvsvc_NETRDFSMANAGERREP
 
 	r->out.result = _srvsvc_NETRDFSMANAGERREPORTSITEINFO(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -4089,7 +4089,7 @@ static bool api_srvsvc_NETRSERVERTRANSPO
 
 	r->out.result = _srvsvc_NETRSERVERTRANSPORTDELEX(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
--- a/source3/librpc/gen_ndr/srv_svcctl.c
+++ b/source3/librpc/gen_ndr/srv_svcctl.c
@@ -46,7 +46,7 @@ static bool api_svcctl_CloseServiceHandl
 	r->out.handle = r->in.handle;
 	r->out.result = _svcctl_CloseServiceHandle(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -126,7 +126,7 @@ static bool api_svcctl_ControlService(st
 
 	r->out.result = _svcctl_ControlService(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -199,7 +199,7 @@ static bool api_svcctl_DeleteService(str
 
 	r->out.result = _svcctl_DeleteService(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -279,7 +279,7 @@ static bool api_svcctl_LockServiceDataba
 
 	r->out.result = _svcctl_LockServiceDatabase(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -365,7 +365,7 @@ static bool api_svcctl_QueryServiceObjec
 
 	r->out.result = _svcctl_QueryServiceObjectSecurity(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -438,7 +438,7 @@ static bool api_svcctl_SetServiceObjectS
 
 	r->out.result = _svcctl_SetServiceObjectSecurity(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -518,7 +518,7 @@ static bool api_svcctl_QueryServiceStatu
 
 	r->out.result = _svcctl_QueryServiceStatus(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -591,7 +591,7 @@ static bool api_svcctl_SetServiceStatus(
 
 	r->out.result = _svcctl_SetServiceStatus(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -666,7 +666,7 @@ static bool api_svcctl_UnlockServiceData
 	r->out.lock = r->in.lock;
 	r->out.result = _svcctl_UnlockServiceDatabase(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -739,7 +739,7 @@ static bool api_svcctl_NotifyBootConfigS
 
 	r->out.result = _svcctl_NotifyBootConfigStatus(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -812,7 +812,7 @@ static bool api_svcctl_SCSetServiceBitsW
 
 	r->out.result = _svcctl_SCSetServiceBitsW(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -892,7 +892,7 @@ static bool api_svcctl_ChangeServiceConf
 
 	r->out.result = _svcctl_ChangeServiceConfigW(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -973,7 +973,7 @@ static bool api_svcctl_CreateServiceW(st
 
 	r->out.result = _svcctl_CreateServiceW(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1065,7 +1065,7 @@ static bool api_svcctl_EnumDependentServ
 
 	r->out.result = _svcctl_EnumDependentServicesW(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1158,7 +1158,7 @@ static bool api_svcctl_EnumServicesStatu
 
 	r->out.result = _svcctl_EnumServicesStatusW(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1238,7 +1238,7 @@ static bool api_svcctl_OpenSCManagerW(st
 
 	r->out.result = _svcctl_OpenSCManagerW(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1318,7 +1318,7 @@ static bool api_svcctl_OpenServiceW(stru
 
 	r->out.result = _svcctl_OpenServiceW(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1404,7 +1404,7 @@ static bool api_svcctl_QueryServiceConfi
 
 	r->out.result = _svcctl_QueryServiceConfigW(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1490,7 +1490,7 @@ static bool api_svcctl_QueryServiceLockS
 
 	r->out.result = _svcctl_QueryServiceLockStatusW(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1563,7 +1563,7 @@ static bool api_svcctl_StartServiceW(str
 
 	r->out.result = _svcctl_StartServiceW(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1644,7 +1644,7 @@ static bool api_svcctl_GetServiceDisplay
 
 	r->out.result = _svcctl_GetServiceDisplayNameW(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1725,7 +1725,7 @@ static bool api_svcctl_GetServiceKeyName
 
 	r->out.result = _svcctl_GetServiceKeyNameW(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1798,7 +1798,7 @@ static bool api_svcctl_SCSetServiceBitsA
 
 	r->out.result = _svcctl_SCSetServiceBitsA(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1878,7 +1878,7 @@ static bool api_svcctl_ChangeServiceConf
 
 	r->out.result = _svcctl_ChangeServiceConfigA(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1958,7 +1958,7 @@ static bool api_svcctl_CreateServiceA(st
 
 	r->out.result = _svcctl_CreateServiceA(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2050,7 +2050,7 @@ static bool api_svcctl_EnumDependentServ
 
 	r->out.result = _svcctl_EnumDependentServicesA(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2143,7 +2143,7 @@ static bool api_svcctl_EnumServicesStatu
 
 	r->out.result = _svcctl_EnumServicesStatusA(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2223,7 +2223,7 @@ static bool api_svcctl_OpenSCManagerA(st
 
 	r->out.result = _svcctl_OpenSCManagerA(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2296,7 +2296,7 @@ static bool api_svcctl_OpenServiceA(stru
 
 	r->out.result = _svcctl_OpenServiceA(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2382,7 +2382,7 @@ static bool api_svcctl_QueryServiceConfi
 
 	r->out.result = _svcctl_QueryServiceConfigA(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2468,7 +2468,7 @@ static bool api_svcctl_QueryServiceLockS
 
 	r->out.result = _svcctl_QueryServiceLockStatusA(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2541,7 +2541,7 @@ static bool api_svcctl_StartServiceA(str
 
 	r->out.result = _svcctl_StartServiceA(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2622,7 +2622,7 @@ static bool api_svcctl_GetServiceDisplay
 
 	r->out.result = _svcctl_GetServiceDisplayNameA(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2703,7 +2703,7 @@ static bool api_svcctl_GetServiceKeyName
 
 	r->out.result = _svcctl_GetServiceKeyNameA(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2776,7 +2776,7 @@ static bool api_svcctl_GetCurrentGroupeS
 
 	r->out.result = _svcctl_GetCurrentGroupeStateW(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2849,7 +2849,7 @@ static bool api_svcctl_EnumServiceGroupW
 
 	r->out.result = _svcctl_EnumServiceGroupW(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2922,7 +2922,7 @@ static bool api_svcctl_ChangeServiceConf
 
 	r->out.result = _svcctl_ChangeServiceConfig2A(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2995,7 +2995,7 @@ static bool api_svcctl_ChangeServiceConf
 
 	r->out.result = _svcctl_ChangeServiceConfig2W(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -3081,7 +3081,7 @@ static bool api_svcctl_QueryServiceConfi
 
 	r->out.result = _svcctl_QueryServiceConfig2A(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -3167,7 +3167,7 @@ static bool api_svcctl_QueryServiceConfi
 
 	r->out.result = _svcctl_QueryServiceConfig2W(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -3253,7 +3253,7 @@ static bool api_svcctl_QueryServiceStatu
 
 	r->out.result = _svcctl_QueryServiceStatusEx(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -3352,7 +3352,7 @@ static bool api_EnumServicesStatusExA(st
 
 	r->out.result = _EnumServicesStatusExA(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -3445,7 +3445,7 @@ static bool api_EnumServicesStatusExW(st
 
 	r->out.result = _EnumServicesStatusExW(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -3518,7 +3518,7 @@ static bool api_svcctl_SCSendTSMessage(s
 
 	r->out.result = _svcctl_SCSendTSMessage(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
--- a/source3/librpc/gen_ndr/srv_trkwks.c
+++ b/source3/librpc/gen_ndr/srv_trkwks.c
@@ -44,7 +44,7 @@ static bool api_trkwks_Unknown0(struct p
 
 	r->out.result = _trkwks_Unknown0(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
--- a/source3/librpc/gen_ndr/srv_unixinfo.c
+++ b/source3/librpc/gen_ndr/srv_unixinfo.c
@@ -51,7 +51,7 @@ static bool api_unixinfo_SidToUid(struct
 
 	r->out.result = _unixinfo_SidToUid(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -131,7 +131,7 @@ static bool api_unixinfo_UidToSid(struct
 
 	r->out.result = _unixinfo_UidToSid(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -211,7 +211,7 @@ static bool api_unixinfo_SidToGid(struct
 
 	r->out.result = _unixinfo_SidToGid(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -291,7 +291,7 @@ static bool api_unixinfo_GidToSid(struct
 
 	r->out.result = _unixinfo_GidToSid(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -372,7 +372,7 @@ static bool api_unixinfo_GetPWUid(struct
 
 	r->out.result = _unixinfo_GetPWUid(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
--- a/source3/librpc/gen_ndr/srv_w32time.c
+++ b/source3/librpc/gen_ndr/srv_w32time.c
@@ -44,7 +44,7 @@ static bool api_w32time_SyncTime(struct
 
 	r->out.result = _w32time_SyncTime(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -117,7 +117,7 @@ static bool api_w32time_GetNetLogonServi
 
 	r->out.result = _w32time_GetNetLogonServiceBits(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -190,7 +190,7 @@ static bool api_w32time_QueryProviderSta
 
 	r->out.result = _w32time_QueryProviderStatus(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
--- a/source3/librpc/gen_ndr/srv_wbint.c
+++ b/source3/librpc/gen_ndr/srv_wbint.c
@@ -51,7 +51,7 @@ static bool api_wbint_Ping(struct pipes_
 
 	_wbint_Ping(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -143,7 +143,7 @@ static bool api_wbint_LookupSid(struct p
 
 	r->out.result = _wbint_LookupSid(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -229,7 +229,7 @@ static bool api_wbint_LookupSids(struct
 
 	r->out.result = _wbint_LookupSids(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -315,7 +315,7 @@ static bool api_wbint_LookupName(struct
 
 	r->out.result = _wbint_LookupName(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -395,7 +395,7 @@ static bool api_wbint_Sid2Uid(struct pip
 
 	r->out.result = _wbint_Sid2Uid(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -475,7 +475,7 @@ static bool api_wbint_Sid2Gid(struct pip
 
 	r->out.result = _wbint_Sid2Gid(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -550,7 +550,7 @@ static bool api_wbint_Sids2UnixIDs(struc
 	r->out.ids = r->in.ids;
 	r->out.result = _wbint_Sids2UnixIDs(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -630,7 +630,7 @@ static bool api_wbint_Uid2Sid(struct pip
 
 	r->out.result = _wbint_Uid2Sid(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -710,7 +710,7 @@ static bool api_wbint_Gid2Sid(struct pip
 
 	r->out.result = _wbint_Gid2Sid(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -790,7 +790,7 @@ static bool api_wbint_AllocateUid(struct
 
 	r->out.result = _wbint_AllocateUid(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -870,7 +870,7 @@ static bool api_wbint_AllocateGid(struct
 
 	r->out.result = _wbint_AllocateGid(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -950,7 +950,7 @@ static bool api_wbint_QueryUser(struct p
 
 	r->out.result = _wbint_QueryUser(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1030,7 +1030,7 @@ static bool api_wbint_LookupUserAliases(
 
 	r->out.result = _wbint_LookupUserAliases(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1110,7 +1110,7 @@ static bool api_wbint_LookupUserGroups(s
 
 	r->out.result = _wbint_LookupUserGroups(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1190,7 +1190,7 @@ static bool api_wbint_QuerySequenceNumbe
 
 	r->out.result = _wbint_QuerySequenceNumber(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1270,7 +1270,7 @@ static bool api_wbint_LookupGroupMembers
 
 	r->out.result = _wbint_LookupGroupMembers(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1350,7 +1350,7 @@ static bool api_wbint_QueryUserList(stru
 
 	r->out.result = _wbint_QueryUserList(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1430,7 +1430,7 @@ static bool api_wbint_QueryGroupList(str
 
 	r->out.result = _wbint_QueryGroupList(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1510,7 +1510,7 @@ static bool api_wbint_DsGetDcName(struct
 
 	r->out.result = _wbint_DsGetDcName(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1596,7 +1596,7 @@ static bool api_wbint_LookupRids(struct
 
 	r->out.result = _wbint_LookupRids(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1669,7 +1669,7 @@ static bool api_wbint_CheckMachineAccoun
 
 	r->out.result = _wbint_CheckMachineAccount(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1742,7 +1742,7 @@ static bool api_wbint_ChangeMachineAccou
 
 	r->out.result = _wbint_ChangeMachineAccount(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1815,7 +1815,7 @@ static bool api_wbint_PingDc(struct pipe
 
 	r->out.result = _wbint_PingDc(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
--- a/source3/librpc/gen_ndr/srv_winreg.c
+++ b/source3/librpc/gen_ndr/srv_winreg.c
@@ -51,7 +51,7 @@ static bool api_winreg_OpenHKCR(struct p
 
 	r->out.result = _winreg_OpenHKCR(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -131,7 +131,7 @@ static bool api_winreg_OpenHKCU(struct p
 
 	r->out.result = _winreg_OpenHKCU(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -211,7 +211,7 @@ static bool api_winreg_OpenHKLM(struct p
 
 	r->out.result = _winreg_OpenHKLM(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -291,7 +291,7 @@ static bool api_winreg_OpenHKPD(struct p
 
 	r->out.result = _winreg_OpenHKPD(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -371,7 +371,7 @@ static bool api_winreg_OpenHKU(struct pi
 
 	r->out.result = _winreg_OpenHKU(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -446,7 +446,7 @@ static bool api_winreg_CloseKey(struct p
 	r->out.handle = r->in.handle;
 	r->out.result = _winreg_CloseKey(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -527,7 +527,7 @@ static bool api_winreg_CreateKey(struct
 
 	r->out.result = _winreg_CreateKey(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -600,7 +600,7 @@ static bool api_winreg_DeleteKey(struct
 
 	r->out.result = _winreg_DeleteKey(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -673,7 +673,7 @@ static bool api_winreg_DeleteValue(struc
 
 	r->out.result = _winreg_DeleteValue(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -750,7 +750,7 @@ static bool api_winreg_EnumKey(struct pi
 	r->out.last_changed_time = r->in.last_changed_time;
 	r->out.result = _winreg_EnumKey(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -829,7 +829,7 @@ static bool api_winreg_EnumValue(struct
 	r->out.length = r->in.length;
 	r->out.result = _winreg_EnumValue(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -902,7 +902,7 @@ static bool api_winreg_FlushKey(struct p
 
 	r->out.result = _winreg_FlushKey(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -977,7 +977,7 @@ static bool api_winreg_GetKeySecurity(st
 	r->out.sd = r->in.sd;
 	r->out.result = _winreg_GetKeySecurity(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1050,7 +1050,7 @@ static bool api_winreg_LoadKey(struct pi
 
 	r->out.result = _winreg_LoadKey(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1123,7 +1123,7 @@ static bool api_winreg_NotifyChangeKeyVa
 
 	r->out.result = _winreg_NotifyChangeKeyValue(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1203,7 +1203,7 @@ static bool api_winreg_OpenKey(struct pi
 
 	r->out.result = _winreg_OpenKey(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1326,7 +1326,7 @@ static bool api_winreg_QueryInfoKey(stru
 
 	r->out.result = _winreg_QueryInfoKey(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1404,7 +1404,7 @@ static bool api_winreg_QueryValue(struct
 	r->out.data_length = r->in.data_length;
 	r->out.result = _winreg_QueryValue(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1477,7 +1477,7 @@ static bool api_winreg_ReplaceKey(struct
 
 	r->out.result = _winreg_ReplaceKey(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1550,7 +1550,7 @@ static bool api_winreg_RestoreKey(struct
 
 	r->out.result = _winreg_RestoreKey(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1623,7 +1623,7 @@ static bool api_winreg_SaveKey(struct pi
 
 	r->out.result = _winreg_SaveKey(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1696,7 +1696,7 @@ static bool api_winreg_SetKeySecurity(st
 
 	r->out.result = _winreg_SetKeySecurity(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1769,7 +1769,7 @@ static bool api_winreg_SetValue(struct p
 
 	r->out.result = _winreg_SetValue(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1842,7 +1842,7 @@ static bool api_winreg_UnLoadKey(struct
 
 	r->out.result = _winreg_UnLoadKey(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1915,7 +1915,7 @@ static bool api_winreg_InitiateSystemShu
 
 	r->out.result = _winreg_InitiateSystemShutdown(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1988,7 +1988,7 @@ static bool api_winreg_AbortSystemShutdo
 
 	r->out.result = _winreg_AbortSystemShutdown(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2068,7 +2068,7 @@ static bool api_winreg_GetVersion(struct
 
 	r->out.result = _winreg_GetVersion(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2148,7 +2148,7 @@ static bool api_winreg_OpenHKCC(struct p
 
 	r->out.result = _winreg_OpenHKCC(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2228,7 +2228,7 @@ static bool api_winreg_OpenHKDD(struct p
 
 	r->out.result = _winreg_OpenHKDD(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2310,7 +2310,7 @@ static bool api_winreg_QueryMultipleValu
 
 	r->out.result = _winreg_QueryMultipleValues(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2383,7 +2383,7 @@ static bool api_winreg_InitiateSystemShu
 
 	r->out.result = _winreg_InitiateSystemShutdownEx(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2456,7 +2456,7 @@ static bool api_winreg_SaveKeyEx(struct
 
 	r->out.result = _winreg_SaveKeyEx(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2536,7 +2536,7 @@ static bool api_winreg_OpenHKPT(struct p
 
 	r->out.result = _winreg_OpenHKPT(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2616,7 +2616,7 @@ static bool api_winreg_OpenHKPN(struct p
 
 	r->out.result = _winreg_OpenHKPN(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2703,7 +2703,7 @@ static bool api_winreg_QueryMultipleValu
 
 	r->out.result = _winreg_QueryMultipleValues2(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2776,7 +2776,7 @@ static bool api_winreg_DeleteKeyEx(struc
 
 	r->out.result = _winreg_DeleteKeyEx(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
--- a/source3/librpc/gen_ndr/srv_wkssvc.c
+++ b/source3/librpc/gen_ndr/srv_wkssvc.c
@@ -51,7 +51,7 @@ static bool api_wkssvc_NetWkstaGetInfo(s
 
 	r->out.result = _wkssvc_NetWkstaGetInfo(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -126,7 +126,7 @@ static bool api_wkssvc_NetWkstaSetInfo(s
 	r->out.parm_error = r->in.parm_error;
 	r->out.result = _wkssvc_NetWkstaSetInfo(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -208,7 +208,7 @@ static bool api_wkssvc_NetWkstaEnumUsers
 
 	r->out.result = _wkssvc_NetWkstaEnumUsers(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -288,7 +288,7 @@ static bool api_wkssvc_NetrWkstaUserGetI
 
 	r->out.result = _wkssvc_NetrWkstaUserGetInfo(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -363,7 +363,7 @@ static bool api_wkssvc_NetrWkstaUserSetI
 	r->out.parm_err = r->in.parm_err;
 	r->out.result = _wkssvc_NetrWkstaUserSetInfo(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -445,7 +445,7 @@ static bool api_wkssvc_NetWkstaTransport
 
 	r->out.result = _wkssvc_NetWkstaTransportEnum(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -520,7 +520,7 @@ static bool api_wkssvc_NetrWkstaTranspor
 	r->out.parm_err = r->in.parm_err;
 	r->out.result = _wkssvc_NetrWkstaTransportAdd(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -593,7 +593,7 @@ static bool api_wkssvc_NetrWkstaTranspor
 
 	r->out.result = _wkssvc_NetrWkstaTransportDel(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -668,7 +668,7 @@ static bool api_wkssvc_NetrUseAdd(struct
 	r->out.parm_err = r->in.parm_err;
 	r->out.result = _wkssvc_NetrUseAdd(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -748,7 +748,7 @@ static bool api_wkssvc_NetrUseGetInfo(st
 
 	r->out.result = _wkssvc_NetrUseGetInfo(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -821,7 +821,7 @@ static bool api_wkssvc_NetrUseDel(struct
 
 	r->out.result = _wkssvc_NetrUseDel(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -903,7 +903,7 @@ static bool api_wkssvc_NetrUseEnum(struc
 
 	r->out.result = _wkssvc_NetrUseEnum(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -976,7 +976,7 @@ static bool api_wkssvc_NetrMessageBuffer
 
 	r->out.result = _wkssvc_NetrMessageBufferSend(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1056,7 +1056,7 @@ static bool api_wkssvc_NetrWorkstationSt
 
 	r->out.result = _wkssvc_NetrWorkstationStatisticsGet(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1129,7 +1129,7 @@ static bool api_wkssvc_NetrLogonDomainNa
 
 	r->out.result = _wkssvc_NetrLogonDomainNameAdd(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1202,7 +1202,7 @@ static bool api_wkssvc_NetrLogonDomainNa
 
 	r->out.result = _wkssvc_NetrLogonDomainNameDel(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1275,7 +1275,7 @@ static bool api_wkssvc_NetrJoinDomain(st
 
 	r->out.result = _wkssvc_NetrJoinDomain(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1348,7 +1348,7 @@ static bool api_wkssvc_NetrUnjoinDomain(
 
 	r->out.result = _wkssvc_NetrUnjoinDomain(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1421,7 +1421,7 @@ static bool api_wkssvc_NetrRenameMachine
 
 	r->out.result = _wkssvc_NetrRenameMachineInDomain(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1494,7 +1494,7 @@ static bool api_wkssvc_NetrValidateName(
 
 	r->out.result = _wkssvc_NetrValidateName(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1575,7 +1575,7 @@ static bool api_wkssvc_NetrGetJoinInform
 
 	r->out.result = _wkssvc_NetrGetJoinInformation(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1656,7 +1656,7 @@ static bool api_wkssvc_NetrGetJoinableOu
 
 	r->out.result = _wkssvc_NetrGetJoinableOus(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1729,7 +1729,7 @@ static bool api_wkssvc_NetrJoinDomain2(s
 
 	r->out.result = _wkssvc_NetrJoinDomain2(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1802,7 +1802,7 @@ static bool api_wkssvc_NetrUnjoinDomain2
 
 	r->out.result = _wkssvc_NetrUnjoinDomain2(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1875,7 +1875,7 @@ static bool api_wkssvc_NetrRenameMachine
 
 	r->out.result = _wkssvc_NetrRenameMachineInDomain2(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1948,7 +1948,7 @@ static bool api_wkssvc_NetrValidateName2
 
 	r->out.result = _wkssvc_NetrValidateName2(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2029,7 +2029,7 @@ static bool api_wkssvc_NetrGetJoinableOu
 
 	r->out.result = _wkssvc_NetrGetJoinableOus2(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2102,7 +2102,7 @@ static bool api_wkssvc_NetrAddAlternateC
 
 	r->out.result = _wkssvc_NetrAddAlternateComputerName(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2175,7 +2175,7 @@ static bool api_wkssvc_NetrRemoveAlterna
 
 	r->out.result = _wkssvc_NetrRemoveAlternateComputerName(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2248,7 +2248,7 @@ static bool api_wkssvc_NetrSetPrimaryCom
 
 	r->out.result = _wkssvc_NetrSetPrimaryComputername(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2328,7 +2328,7 @@ static bool api_wkssvc_NetrEnumerateComp
 
 	r->out.result = _wkssvc_NetrEnumerateComputerNames(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
--- a/source3/librpc/gen_ndr/srv_wmi.c
+++ b/source3/librpc/gen_ndr/srv_wmi.c
@@ -51,7 +51,7 @@ static bool api_Delete(struct pipes_stru
 
 	r->out.result = _Delete(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -155,7 +155,7 @@ static bool api_OpenNamespace(struct pip
 
 	r->out.result = _OpenNamespace(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -235,7 +235,7 @@ static bool api_CancelAsyncCall(struct p
 
 	r->out.result = _CancelAsyncCall(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -321,7 +321,7 @@ static bool api_QueryObjectSink(struct p
 
 	r->out.result = _QueryObjectSink(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -403,7 +403,7 @@ static bool api_GetObject(struct pipes_s
 
 	r->out.result = _GetObject(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -483,7 +483,7 @@ static bool api_GetObjectAsync(struct pi
 
 	r->out.result = _GetObjectAsync(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -564,7 +564,7 @@ static bool api_PutClass(struct pipes_st
 
 	r->out.result = _PutClass(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -644,7 +644,7 @@ static bool api_PutClassAsync(struct pip
 
 	r->out.result = _PutClassAsync(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -725,7 +725,7 @@ static bool api_DeleteClass(struct pipes
 
 	r->out.result = _DeleteClass(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -805,7 +805,7 @@ static bool api_DeleteClassAsync(struct
 
 	r->out.result = _DeleteClassAsync(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -891,7 +891,7 @@ static bool api_CreateClassEnum(struct p
 
 	r->out.result = _CreateClassEnum(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -971,7 +971,7 @@ static bool api_CreateClassEnumAsync(str
 
 	r->out.result = _CreateClassEnumAsync(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1052,7 +1052,7 @@ static bool api_PutInstance(struct pipes
 
 	r->out.result = _PutInstance(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1132,7 +1132,7 @@ static bool api_PutInstanceAsync(struct
 
 	r->out.result = _PutInstanceAsync(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1213,7 +1213,7 @@ static bool api_DeleteInstance(struct pi
 
 	r->out.result = _DeleteInstance(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1293,7 +1293,7 @@ static bool api_DeleteInstanceAsync(stru
 
 	r->out.result = _DeleteInstanceAsync(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1379,7 +1379,7 @@ static bool api_CreateInstanceEnum(struc
 
 	r->out.result = _CreateInstanceEnum(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1459,7 +1459,7 @@ static bool api_CreateInstanceEnumAsync(
 
 	r->out.result = _CreateInstanceEnumAsync(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1545,7 +1545,7 @@ static bool api_ExecQuery(struct pipes_s
 
 	r->out.result = _ExecQuery(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1625,7 +1625,7 @@ static bool api_ExecQueryAsync(struct pi
 
 	r->out.result = _ExecQueryAsync(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1711,7 +1711,7 @@ static bool api_ExecNotificationQuery(st
 
 	r->out.result = _ExecNotificationQuery(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1791,7 +1791,7 @@ static bool api_ExecNotificationQueryAsy
 
 	r->out.result = _ExecNotificationQueryAsync(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1873,7 +1873,7 @@ static bool api_ExecMethod(struct pipes_
 
 	r->out.result = _ExecMethod(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1953,7 +1953,7 @@ static bool api_ExecMethodAsync(struct p
 
 	r->out.result = _ExecMethodAsync(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2077,7 +2077,7 @@ static bool api_Reset(struct pipes_struc
 
 	r->out.result = _Reset(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2169,7 +2169,7 @@ static bool api_IEnumWbemClassObject_Nex
 
 	r->out.result = _IEnumWbemClassObject_Next(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2249,7 +2249,7 @@ static bool api_NextAsync(struct pipes_s
 
 	r->out.result = _NextAsync(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2335,7 +2335,7 @@ static bool api_IEnumWbemClassObject_Clo
 
 	r->out.result = _IEnumWbemClassObject_Clone(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2415,7 +2415,7 @@ static bool api_Skip(struct pipes_struct
 
 	r->out.result = _Skip(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2527,7 +2527,7 @@ static bool api_Clone(struct pipes_struc
 
 	r->out.result = _Clone(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2607,7 +2607,7 @@ static bool api_GetNames(struct pipes_st
 
 	r->out.result = _GetNames(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2687,7 +2687,7 @@ static bool api_BeginEnumeration(struct
 
 	r->out.result = _BeginEnumeration(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2767,7 +2767,7 @@ static bool api_Next(struct pipes_struct
 
 	r->out.result = _Next(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2847,7 +2847,7 @@ static bool api_EndEnumeration(struct pi
 
 	r->out.result = _EndEnumeration(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -2927,7 +2927,7 @@ static bool api_SetValue(struct pipes_st
 
 	r->out.result = _SetValue(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -3007,7 +3007,7 @@ static bool api_GetValue(struct pipes_st
 
 	r->out.result = _GetValue(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -3087,7 +3087,7 @@ static bool api_DeleteValue(struct pipes
 
 	r->out.result = _DeleteValue(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -3167,7 +3167,7 @@ static bool api_DeleteAll(struct pipes_s
 
 	r->out.result = _DeleteAll(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -3283,7 +3283,7 @@ static bool api_EstablishPosition(struct
 
 	r->out.result = _EstablishPosition(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -3369,7 +3369,7 @@ static bool api_RequestChallenge(struct
 
 	r->out.result = _RequestChallenge(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -3455,7 +3455,7 @@ static bool api_WBEMLogin(struct pipes_s
 
 	r->out.result = _WBEMLogin(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -3541,7 +3541,7 @@ static bool api_NTLMLogin(struct pipes_s
 
 	r->out.result = _NTLMLogin(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -3664,7 +3664,7 @@ static bool api_IWbemWCOSmartEnum_Next(s
 
 	r->out.result = _IWbemWCOSmartEnum_Next(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -3772,7 +3772,7 @@ static bool api_Fetch(struct pipes_struc
 
 	r->out.result = _Fetch(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -3858,7 +3858,7 @@ static bool api_Test(struct pipes_struct
 
 	r->out.result = _Test(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -3967,7 +3967,7 @@ static bool api_GetResultObject(struct p
 
 	r->out.result = _GetResultObject(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -4053,7 +4053,7 @@ static bool api_GetResultString(struct p
 
 	r->out.result = _GetResultString(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -4139,7 +4139,7 @@ static bool api_GetResultServices(struct
 
 	r->out.result = _GetResultServices(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -4225,7 +4225,7 @@ static bool api_GetCallStatus(struct pip
 
 	r->out.result = _GetCallStatus(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -4330,7 +4330,7 @@ static bool api_SetStatus(struct pipes_s
 
 	r->out.result = _SetStatus(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -4410,7 +4410,7 @@ static bool api_Indicate(struct pipes_st
 
 	r->out.result = _Indicate(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
--- a/source3/librpc/gen_ndr/srv_wzcsvc.c
+++ b/source3/librpc/gen_ndr/srv_wzcsvc.c
@@ -44,7 +44,7 @@ static bool api_wzcsvc_EnumInterfaces(st
 
 	_wzcsvc_EnumInterfaces(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -117,7 +117,7 @@ static bool api_wzcsvc_QueryInterface(st
 
 	_wzcsvc_QueryInterface(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -190,7 +190,7 @@ static bool api_wzcsvc_SetInterface(stru
 
 	_wzcsvc_SetInterface(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -263,7 +263,7 @@ static bool api_wzcsvc_RefreshInterface(
 
 	_wzcsvc_RefreshInterface(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -336,7 +336,7 @@ static bool api_wzcsvc_QueryContext(stru
 
 	_wzcsvc_QueryContext(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -409,7 +409,7 @@ static bool api_wzcsvc_SetContext(struct
 
 	_wzcsvc_SetContext(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -482,7 +482,7 @@ static bool api_wzcsvc_EapolUIResponse(s
 
 	_wzcsvc_EapolUIResponse(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -555,7 +555,7 @@ static bool api_wzcsvc_EapolGetCustomAut
 
 	_wzcsvc_EapolGetCustomAuthData(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -628,7 +628,7 @@ static bool api_wzcsvc_EapolSetCustomAut
 
 	_wzcsvc_EapolSetCustomAuthData(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -701,7 +701,7 @@ static bool api_wzcsvc_EapolGetInterface
 
 	_wzcsvc_EapolGetInterfaceParams(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -774,7 +774,7 @@ static bool api_wzcsvc_EapolSetInterface
 
 	_wzcsvc_EapolSetInterfaceParams(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -847,7 +847,7 @@ static bool api_wzcsvc_EapolReAuthentica
 
 	_wzcsvc_EapolReAuthenticateInterface(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -920,7 +920,7 @@ static bool api_wzcsvc_EapolQueryInterfa
 
 	_wzcsvc_EapolQueryInterfaceState(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -993,7 +993,7 @@ static bool api_wzcsvc_OpenWZCDbLogSessi
 
 	_wzcsvc_OpenWZCDbLogSession(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1066,7 +1066,7 @@ static bool api_wzcsvc_CloseWZCDbLogSess
 
 	_wzcsvc_CloseWZCDbLogSession(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1139,7 +1139,7 @@ static bool api_wzcsvc_EnumWZCDbLogRecor
 
 	_wzcsvc_EnumWZCDbLogRecords(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1212,7 +1212,7 @@ static bool api_wzcsvc_FlushWZCdbLog(str
 
 	_wzcsvc_FlushWZCdbLog(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
@@ -1285,7 +1285,7 @@ static bool api_wzcsvc_GetWZCDbLogRecord
 
 	_wzcsvc_GetWZCDbLogRecord(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
--- a/source3/librpc/gen_ndr/srv_xattr.c
+++ b/source3/librpc/gen_ndr/srv_xattr.c
@@ -44,7 +44,7 @@ static bool api_xattr_parse_DOSATTRIB(st
 
 	_xattr_parse_DOSATTRIB(p, r);
 
-	if (p->rng_fault_state) {
+	if (p->fault_state) {
 		talloc_free(r);
 		/* Return true here, srv_pipe_hnd.c will take care */
 		return true;
