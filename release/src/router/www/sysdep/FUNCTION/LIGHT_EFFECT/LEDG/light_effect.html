<head>
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<link rel="stylesheet" type="text/css" href="/light_effect/light_effect.css" />
<link rel="stylesheet" type="text/css" href="/light_effect/light_effect_sysdep.css" />
<script type="text/javascript" src="/js/jquery.js"></script>
<script type="text/javascript" src="/calendar/jquery-ui.js"></script>
<script type="text/javascript" src="/js/httpApi.js"></script>
<script type="text/javascript" src="/light_effect/specific_schema.js"></script>
</head>
<script >
var model_info = httpApi.nvramGet(["productid", "CoBrand"]);
$(function(){
	var getUrlParameter = function getUrlParameter(param){
		var url_parm = window.location.search.substring(1);
		var parm_array = url_parm.split("&");
		var key_value;

		for(var i = 0; i < parm_array.length; i += 1){
			key_value = parm_array[i].split("=");
			if (key_value[0] == param) {
				return typeof key_value[1] == "undefined" ? "" : decodeURIComponent(key_value[1]);
			}
		}
		return "";
	};

	var theme = getUrlParameter("current_theme").toLocaleLowerCase();
	if(theme == "white"){
		$('link[href*="/light_effect/light_effect_' + theme + '.css"]').remove();
		$('link').last().after('<link rel="stylesheet" type="text/css" href="/light_effect/light_effect_' + theme + '.css">');
	}

	if(isSupport("antled")){
		$('<script />', { type : 'text/javascript', src : "/light_effect/antenna.js"}).appendTo('head');
	}
	if(model_info.productid.substr(0,2) == "GT"){
		$("#light_effect_bg .light_effect_mask").addClass("rog");
	}
});
var $light_effect_bg = $("#light_effect_bg");
var $hue_bar = $("#hue_bar");
var $hue_slider = $("#hue_slider");
var hue_click = false;
var hsl = {h:0, s:100, l:50};
var scheme_page_idx = 1;
var scheme_page_max_count = 4;
var scheme_pages = 1;
var scheme_item_post = {
	"LED_Set" : {},
	"Mode" : 6
}
var ledg_group = ((isSupport("ledg_count") == 0) ? 4 : isSupport("ledg_count"));
for(var i = 1; i <= ledg_group; i += 1){
	var led_group = {};
	led_group[i] = {"R" : 0, "G" : 0, "B" : 128};
	$.extend(true, scheme_item_post.LED_Set, led_group);
}
var gradient_color = retune_gradient_color({"ledg_group":ledg_group, "productid":model_info.productid, "CoBrand":model_info.CoBrand});
function initial_led_control() {
	var set_scheme_item_post = function(_ledg_rgb) {
		var ledg_rgb_array = _ledg_rgb.split(",");
		if(ledg_rgb_array.length == (ledg_group * 3)) {
			for(var i = 0; i < ledg_rgb_array.length; i += 3) {
				var group_idx = (Math.floor(i / 3)) + 1;
				scheme_item_post["LED_Set"][group_idx]["R"] = multiply_rgb(parseInt(ledg_rgb_array[i]));
				scheme_item_post["LED_Set"][group_idx]["G"] = multiply_rgb(parseInt(ledg_rgb_array[i+1]));
				scheme_item_post["LED_Set"][group_idx]["B"] = multiply_rgb(parseInt(ledg_rgb_array[i+2]));
			}
		}
	};

	if(model_info.productid == "TUF-AX5400")
		$("#light_effect_setting .scheme_bg:not(#static, #breathing, #wave, #rainbow)").remove();

	$light_effect_bg = $("#light_effect_bg");
	$hue_bar = $("#hue_bar");
	$hue_slider = $("#hue_slider");
	if($("#light_effect_setting .light_effect_setting_bg .setting_enable_bg .schedule").css("display") != "none")
		$("#light_effect_setting .light_effect_setting_bg .setting_enable_bg .switch").css("right", "20%");

	if(!isMobile()) {
		$hue_bar.mousedown(function(e) {
			if($("#light_effect_setting .setting_hue").css("opacity") == "1") {
				if(e.target.id == "hue_bar") {
					hue_click = true;
					set_hue_value(e);
				}
				else {
					hue_click = true;
					$hue_slider.addClass("active");
				}
				lightl_effect_animate.clear($light_effect_bg);
			}
		});
		$(document).mousemove(function(e) {
			if(hue_click) {
				set_hue_value(e);
			}
		});
		$(document).mouseup(function(e) {
			if(hue_click) {
				set_light_effect();
			}
		});
	}
	else {
		$("#light_effect_setting .setting_scheme").removeClass("support_hover");
		$("#light_effect_setting .light_effect_setting_bg").addClass("no_highlights");
		$hue_bar[0].addEventListener("touchstart", function (e) {
			if($("#light_effect_setting .setting_hue").css("opacity") == "1") {
				if(e.target.id == "hue_bar") {
					hue_click = true;
					set_hue_value(e);
				}
				else {
					hue_click = true;
					$hue_slider.addClass("active");
				}
				lightl_effect_animate.clear($light_effect_bg);
			}
		});
		document.addEventListener("touchmove", function (e) {
			if(hue_click) {
				set_hue_value(e);
			}
		});
		document.addEventListener("touchend", function (e) {
			if(hue_click) {
				set_light_effect();
			}
		});
	}

	$("#light_effect_setting .setting_enable_bg .switch").unbind("click").click(function(e){
		e = e || event;
		e.stopPropagation();
		var AllLED = httpApi.nvramGet(["AllLED"]).AllLED;
		if(AllLED == "1"){
			$("#light_effect_setting .setting_enable_bg .switch").toggleClass("off on").promise().done(function(){
				var switch_status = $("#light_effect_setting .setting_enable_bg .switch").hasClass("on");
				lightl_effect_animate.clear($light_effect_bg);
				if(switch_status){
					$(".light_effect_setting_bg .switch_off").show();
					scheme_item_post.Mode = $("#light_effect_setting .scheme_bg.active").attr("Mode");
					set_scheme_mode(scheme_item_post.Mode, scheme_item_post["LED_Set"]);
				}
				else{
					$(".light_effect_setting_bg .switch_off").hide();
					scheme_item_post.Mode = "0";
					$light_effect_bg.removeClass().addClass("light_effect_bg");
					$light_effect_bg.css("background", "initial");
				}

				var postData = {"ledg_scheme": scheme_item_post.Mode};
				httpApi.set_ledg(postData);
				if(isSupport("antled")){
					antenna_switch_enable(switch_status);
				}
			});
		}
	});
	$("#light_effect_setting .setting_scheme .scheme_bg").unbind("click").click(function(e){
		e = e || event;
		e.stopPropagation();
		var id = e.currentTarget.id;
		if(id == "")
			return;
		lightl_effect_animate.clear($light_effect_bg);
		$light_effect_bg.removeClass().addClass("light_effect_bg");
		var mode = e.currentTarget.getAttribute("mode");
		$("#light_effect_setting .setting_scheme .scheme_bg").removeClass("active");
		$("#light_effect_setting .setting_scheme #" + id + "").addClass("active");
		var ledg_rgb = httpApi.nvramGet(["ledg_rgb" + mode + ""], true)["ledg_rgb" + mode + ""];
		if(mode == "6")
			ledg_rgb = retune_wave_color({"ledg_group":ledg_group, "productid":model_info.productid, "CoBrand":model_info.CoBrand});
		set_scheme_item_post(ledg_rgb);
		set_scheme_mode(mode, scheme_item_post["LED_Set"]);
		var postData = {"ledg_scheme": scheme_item_post.Mode};
		if(scheme_item_post.Mode == "1" || scheme_item_post.Mode == "2" || scheme_item_post.Mode == "3" || scheme_item_post.Mode == "7") {
			var ledg_rgb_post = [];
			Object.keys(scheme_item_post["LED_Set"]).forEach(function(group_idx) {
				ledg_rgb_post.push(Math.ceil(scheme_item_post["LED_Set"][group_idx]["R"] / 2));
				ledg_rgb_post.push(Math.ceil(scheme_item_post["LED_Set"][group_idx]["G"] / 2));
				ledg_rgb_post.push(Math.ceil(scheme_item_post["LED_Set"][group_idx]["B"] / 2));
			});
			postData["ledg_rgb"] = ledg_rgb_post.join(',');
		}
		httpApi.set_ledg(postData);
	});
	$("#light_effect_setting .scheme_list_bg .boundary").unbind("click").click(function(e){
		e = e || event;
		e.stopPropagation();
		var id = e.currentTarget.id.replace("boundary_", "");
		if(id == "left")
			scheme_page_idx = Math.max(1, (scheme_page_idx - 1));
		else if(id == "right")
			scheme_page_idx = Math.min(scheme_pages, (scheme_page_idx + 1));
		control_scheme_list(scheme_page_idx);
	});
	$("#default_set").unbind("click").click(function(e){
		e = e || event;
		e.stopPropagation();
		if($("#light_effect_setting .setting_hue").css("opacity") == "1"){
			lightl_effect_animate.clear($light_effect_bg);
			$light_effect_bg.removeClass().addClass("light_effect_bg");
			var mode = $("#light_effect_setting .scheme_list_bg .scheme_bg.active").attr("mode");
			var ledg_rgb = httpApi.nvramDefaultGet(["ledg_rgb" + mode + ""])["ledg_rgb" + mode + ""];
			if(mode == "6")
				ledg_rgb = retune_wave_color({"ledg_group":ledg_group, "productid":model_info.productid, "CoBrand":model_info.CoBrand});
			set_scheme_item_post(ledg_rgb);
			set_scheme_mode(mode, scheme_item_post["LED_Set"]);
			var postData = {"ledg_scheme": scheme_item_post.Mode};
			if(scheme_item_post.Mode == "1" || scheme_item_post.Mode == "2" || scheme_item_post.Mode == "3" || scheme_item_post.Mode == "7") {
				var ledg_rgb_post = [];
				Object.keys(scheme_item_post["LED_Set"]).forEach(function(group_idx) {
					ledg_rgb_post.push(Math.ceil(scheme_item_post["LED_Set"][group_idx]["R"] / 2));
					ledg_rgb_post.push(Math.ceil(scheme_item_post["LED_Set"][group_idx]["G"] / 2));
					ledg_rgb_post.push(Math.ceil(scheme_item_post["LED_Set"][group_idx]["B"] / 2));
				});
				postData["ledg_rgb"] = ledg_rgb_post.join(',');
			}
			httpApi.set_ledg(postData);
		}
	});

	var ledg_info = httpApi.nvramGet(["ledg_scheme", "ledg_scheme_old", "AllLED"], true);
	var ledg_scheme = ledg_info.ledg_scheme;
	var AllLED = ledg_info.AllLED;
	if(AllLED == "0"){
		$("#light_effect_setting .all_led_off").show();
		ledg_scheme = "0";
	}
	else{
		if(ledg_scheme != "0"){
			if($("#light_effect_setting .scheme_list_bg .setting_scheme .scheme_bg[mode=" + ledg_scheme + "]").length == 0){
				ledg_scheme = httpApi.nvramDefaultGet(["ledg_scheme"]).ledg_scheme;
			}
		}
	}

	var ledg_scheme_old = ledg_info.ledg_scheme_old;
	var ledg_rgb = httpApi.nvramGet(["ledg_rgb" + ledg_scheme + ""], true)["ledg_rgb" + ledg_scheme + ""];
	if(ledg_scheme == "1" ||ledg_scheme == "2" || ledg_scheme == "3" || ledg_scheme == "7" || ledg_scheme == "6" || (ledg_scheme == "0" && ledg_scheme_old != "")) {
		var ledg_rgb_idx = ledg_scheme;
		if(ledg_rgb_idx == "0")
			ledg_rgb_idx = ledg_scheme_old;
		var ledg_rgb = "";
		if(ledg_rgb_idx == "6")//wave
			ledg_rgb = ledg_rgb = retune_wave_color({"ledg_group":ledg_group, "productid":model_info.productid, "CoBrand":model_info.CoBrand});
		else
			ledg_rgb = httpApi.nvramGet(["ledg_rgb" + ledg_rgb_idx + ""], true)["ledg_rgb" + ledg_rgb_idx + ""];

		set_scheme_item_post(ledg_rgb);
		scheme_item_post.Mode = ledg_rgb_idx;
	}
	else {
		scheme_item_post.Mode = ledg_scheme;
	}

	$("#light_effect_setting .scheme_list_bg .setting_scheme .scheme_bg[mode=" + scheme_item_post.Mode + "]").addClass("active");
	if(ledg_scheme == "0") {
		$("#light_effect_setting .setting_enable_bg .switch").addClass("off");
		lightl_effect_animate.clear($light_effect_bg);
		$(".light_effect_setting_bg .switch_off").hide();
		$light_effect_bg.removeClass().addClass("light_effect_bg");
		$light_effect_bg.css("background", "initial");
	}
	else {
		$("#light_effect_setting .setting_enable_bg .switch").addClass("on");
		var count = 0;
		var interval_check = setInterval(function() {
			if(get_offset($hue_bar).width != 0) {
				set_scheme_mode(scheme_item_post.Mode, scheme_item_post["LED_Set"]);
				clearInterval(interval_check);
			}
			else {
				count++;
				if(count == 500)
					clearInterval(interval_check);
			}
		}, 50);
	}

	$("#light_effect_setting .scheme_list_bg .setting_scheme .scheme_bg").each(function(idx) {
		if($(this).hasClass("active"))
			scheme_page_idx = Math.ceil((idx + 1) / scheme_page_max_count);
	});
	scheme_pages = Math.ceil(($("#light_effect_setting .scheme_list_bg .setting_scheme .scheme_bg").length / scheme_page_max_count));
	control_scheme_list(scheme_page_idx);

	if(isSupport("antled")){
		$(".logo_container").addClass("support_switch_mode");
		$(".light_effect_bg .mode_list_bg div").unbind("click").click(function(e){
			e = e || event;
			e.stopPropagation();
			switch_mode($(this).attr("mode"));
		});
		init_antenna_led(ledg_scheme);
		switch_mode("panel");
	}
	else{
		$("#antenna_bg, #antenna_setting, .switch_mode_list_bg").remove();
	}
}
function set_scheme_mode(_type, _LED_Set_Obj){
	Object.keys(_LED_Set_Obj).forEach(function(group_idx) {
		scheme_item_post["LED_Set"][group_idx]["R"] = _LED_Set_Obj[group_idx]["R"];
		scheme_item_post["LED_Set"][group_idx]["G"] = _LED_Set_Obj[group_idx]["G"];
		scheme_item_post["LED_Set"][group_idx]["B"] = _LED_Set_Obj[group_idx]["B"];
	});

	var group_rgb = scheme_item_post["LED_Set"];
	var hue_slider_rgb = [group_rgb[1]["R"],group_rgb[1]["G"],group_rgb[1]["B"]];
	switch(_type) {
		case "2" :
			rgbToLeft(hue_slider_rgb);
			$light_effect_bg.css("background", "rgb("+ group_rgb[1]["R"] + ", " + group_rgb[1]["G"] + ", " + group_rgb[1]["B"] + ")");
			$("#light_effect_setting .setting_hue").fadeTo(0, 1);
			scheme_item_post.Mode = "2";//static
			break;
		case "3" :
			rgbToLeft(hue_slider_rgb);
			$light_effect_bg.css("background", "rgb("+ group_rgb[1]["R"] + ", " + group_rgb[1]["G"] + ", " + group_rgb[1]["B"] + ")");
			lightl_effect_animate.breathing($light_effect_bg, hue_slider_rgb);
			$("#light_effect_setting .setting_hue").fadeTo(0, 1);
			scheme_item_post.Mode = "3";//breathing
			break;
		case "6" :
			$light_effect_bg.css("background", "rgb("+ group_rgb[1]["R"] + ", " + group_rgb[1]["G"] + ", " + group_rgb[1]["B"] + ")");
			lightl_effect_animate.wave($light_effect_bg, hue_slider_rgb);
			$("#light_effect_setting .setting_hue").fadeTo(0, 0);
			scheme_item_post.Mode = "6";//wave
			break;
		case "7" :
			rgbToLeft(hue_slider_rgb);
			$light_effect_bg.css("background", "rgb("+ group_rgb[1]["R"] + ", " + group_rgb[1]["G"] + ", " + group_rgb[1]["B"] + ")");
			lightl_effect_animate.marquee($light_effect_bg, hue_slider_rgb);
			$("#light_effect_setting .setting_hue").fadeTo(0, 1);
			scheme_item_post.Mode = "7";//marquee
			break;
		case "1" :
			var gradient_current_rgb = [];
			var gradient_display_rgb = [];
			Object.keys(scheme_item_post["LED_Set"]).forEach(function(group_idx) {
				gradient_current_rgb.push(Math.ceil(scheme_item_post["LED_Set"][group_idx]["R"] / 2));
				gradient_current_rgb.push(Math.ceil(scheme_item_post["LED_Set"][group_idx]["G"] / 2));
				gradient_current_rgb.push(Math.ceil(scheme_item_post["LED_Set"][group_idx]["B"] / 2));
				gradient_display_rgb.push(scheme_item_post["LED_Set"][group_idx]["R"] + ", " + scheme_item_post["LED_Set"][group_idx]["G"] + ", " + scheme_item_post["LED_Set"][group_idx]["B"]);
			});
			var left = 0;
			$.each(gradient_color, function(key, value) {
				var gradient_group_color = gradient_color[key]["color"];
				if(JSON.stringify(gradient_group_color) == JSON.stringify(gradient_current_rgb)) {
					left = gradient_color[key]["left"];
					return false;
				}
			});
			$hue_slider.css("left", gradient_transform_left(left));
			hsl.h = Math.round(parseInt($hue_slider.css("left")) / get_offset($hue_bar).width * 360);
			$hue_slider.css("background" , "hsl(" + hsl.h + ", " + hsl.s + "%" + ", " + hsl.l + "%" + ")");
			var gradient_css = set_gradient_css({"ledg_group":ledg_group, "rgb":gradient_display_rgb});
			$light_effect_bg.css(gradient_css);
			$("#light_effect_setting .setting_hue").fadeTo(0, 1);
			scheme_item_post.Mode = "1";//gradient
			break;
		case "4" :
			$light_effect_bg.addClass("evolution");
			if(model_info.CoBrand == "2")
				$light_effect_bg.addClass("CoBrand_2");
			else if(model_info.CoBrand == "3")
				$light_effect_bg.addClass("CoBrand_3");
			$("#light_effect_setting .setting_hue").fadeTo(0, 0);
			scheme_item_post.Mode = "4";//evolution
			break;
		case "5" :
			$light_effect_bg.addClass("rainbow");
			$("#light_effect_setting .setting_hue").fadeTo(0, 0);
			scheme_item_post.Mode = "5";//rainbow
			break;
	}
}
function isMobile() {
	if( navigator.userAgent.match(/iPhone/i) ||
		navigator.userAgent.match(/iPod/i)    ||
		navigator.userAgent.match(/iPad/i)    ||
		(navigator.userAgent.match(/Android/i) && (navigator.userAgent.match(/Mobile/i) || navigator.userAgent.match(/Tablet/i))) ||
		(navigator.userAgent.match(/Opera/i) && (navigator.userAgent.match(/Mobi/i) || navigator.userAgent.match(/Mini/i))) ||
		navigator.userAgent.match(/IEMobile/i)  ||
		navigator.userAgent.match(/BlackBerry/i) ||
		navigator.userAgent.match(/asusrouter/i)
	)
		return true;
	else
		return false;
}
var color_converter = {
	"RGBtoHSL" : function(rgbArr) {
		var R = rgbArr[0] / 255;
		var G = rgbArr[1] / 255;
		var B = rgbArr[2] / 255;
		var maxColor = Math.max(R,G,B);
		var minColor = Math.min(R,G,B);
		var L = (maxColor + minColor) / 2;
		var S = 0;
		var H = 0;
		var HSL = [];
		if(maxColor != minColor) {
			if(L < 0.5)
				S = (maxColor - minColor) / (maxColor + minColor);
			else
				S = (maxColor - minColor) / (2.0 - maxColor - minColor);

			if(R == maxColor)
				H = (G - B) / (maxColor - minColor);
			else if(G == maxColor)
				H = 2.0 + (B - R) / (maxColor - minColor);
			else
				H = 4.0 + (R - G) / (maxColor - minColor);
		}

		L = Math.round(L * 100);
		S = Math.round(S * 100);
		H = Math.round(H * 60);
		if(H < 0)
			H += 360;

		HSL = [H, S, L];
		return HSL;
	},
	"RGBtoHEX" : function(rgbArr) {
		var R = rgbArr[0].toString(16);
		var G = rgbArr[1].toString(16);
		var B = rgbArr[2].toString(16);
		R.length == 1 ? R = "0" + R : R;
		G.length == 1 ? G = "0" + G : G;
		B.length == 1 ? B = "0" + B : B;
		return "#" + R + G + B;
	},
	"HSLtoRGB" : function(hslArr) {
		var H = hslArr[0] / 360;
		var S = hslArr[1] / 100;
		var L = hslArr[2] / 100;
		var RGB = [];
		if(S == 0)
			RGB = [Math.round(L*255),Math.round(L*255),Math.round(L*255)];
		else{
			var q = L >= 0.5 ? (L + S - L * S) : (L * (1 + S));
			var p = 2 * L - q;
			var tr = RGB[0] = H + 1 / 3;
			var tg = RGB[1] = H;
			var tb = RGB[2] = H - 1 / 3;
			for(var i = 0; i < RGB.length; i++) {
				var tc = RGB[i];
				if(tc < 0)
					tc = tc + 1;
				else if(tc > 1)
					tc = tc - 1;
				switch(true) {
					case (tc < (1 / 6)):
						tc = p + (q - p) * 6 * tc;
						break;
					case ((1 / 6) <= tc && tc < 0.5):
						tc = q;
						break;
					case (0.5 <= tc && tc < (2 / 3)):
						tc = p + (q - p) * (4 - 6 * tc);
						break;
					default:
						tc = p;
						break;
				}
				RGB[i] = Math.round(tc * 255);
			}
		}
		return RGB;
	},
};
function get_offset(element) {
	var y = parseInt(element[0].getBoundingClientRect().top);
	var x = parseInt(element[0].getBoundingClientRect().left);
	var height = parseInt(element[0].offsetHeight);
	var width = parseInt(element[0].offsetWidth);
	return {"x": x, "y": y, "height": height, "width": width};
}
function set_hue_value(e) {
	var x = 0;
	var left = 0;
	if(isMobile())
		x = e.touches[0].pageX - get_offset($hue_bar).x;
	else
		x = e.pageX - get_offset($hue_bar).x;
	left = Math.max(Math.min(x, get_offset($hue_bar).width),0);
	$hue_slider.css("left", left);
	$hue_slider.addClass("active");
	hsl.h = Math.round(parseInt($hue_slider.css("left")) / get_offset($hue_bar).width * 360);
	if(hsl.h == 360)
		hsl.h = 359;//avoid slider same as 255,0,0
	$hue_slider.css("background" , "hsl(" + hsl.h + ", " + hsl.s + "%" + ", " + hsl.l + "%" + ")");
	if(scheme_item_post.Mode == "1") {
		var select_id = "id1";
		$.each(gradient_color, function(key, value) {
			var gradient_left = gradient_transform_left(gradient_color[key]["left"]);
			if(left > gradient_left)
				select_id = key;
			else if(left < gradient_color["id2"]["left"]) {
				select_id = "id1";
				return false;
			}
			else
				return false;
		});
		var gradient_current_rgb = gradient_color[select_id].color.join().split(",");
		var gradient_display_rgb = [];
		if(gradient_current_rgb.length == (ledg_group * 3)) {
			for(var i = 0; i < gradient_current_rgb.length; i += 3) {
				var group_idx = (Math.floor(i / 3)) + 1;
				scheme_item_post["LED_Set"][group_idx]["R"] = multiply_rgb(parseInt(gradient_current_rgb[i]));
				scheme_item_post["LED_Set"][group_idx]["G"] = multiply_rgb(parseInt(gradient_current_rgb[i+1]));
				scheme_item_post["LED_Set"][group_idx]["B"] = multiply_rgb(parseInt(gradient_current_rgb[i+2]));
				gradient_display_rgb.push(scheme_item_post["LED_Set"][group_idx]["R"] + ", " + scheme_item_post["LED_Set"][group_idx]["G"] + ", " + scheme_item_post["LED_Set"][group_idx]["B"]);
			}
		}
		var gradient_css = set_gradient_css({"ledg_group":ledg_group, "rgb":gradient_display_rgb});
		$light_effect_bg.css(gradient_css);
	}
	else
		$light_effect_bg.css("background" , "hsl(" + hsl.h + ", " + hsl.s + "%" + ", " + hsl.l + "%" + ")");
}
function set_light_effect() {
	var select_rgb = $("#light_effect_setting .hue_slider").css("background-color").replace('rgb(', '').replace(')','' ).split(',').map(Number);
	$hue_slider.removeClass("active");
	hue_click = false;
	if($("#light_effect_setting .scheme_bg.active")[0].id == "breathing") {
		rgbToLeft(select_rgb);
		$light_effect_bg.css("background", "rgb("+ select_rgb[0] + ", " + select_rgb[1] + ", " + select_rgb[2] + ")");
		lightl_effect_animate.breathing($light_effect_bg, select_rgb);
	}
	if($("#light_effect_setting .scheme_bg.active")[0].id == "marquee") {
		rgbToLeft(select_rgb);
		$light_effect_bg.css("background", "rgb("+ select_rgb[0] + ", " + select_rgb[1] + ", " + select_rgb[2] + ")");
		lightl_effect_animate.marquee($light_effect_bg, select_rgb);
	}
	if($("#light_effect_setting .scheme_bg.active")[0].id == "wave") {
		rgbToLeft(select_rgb);
		$light_effect_bg.css("background", "rgb("+ select_rgb[0] + ", " + select_rgb[1] + ", " + select_rgb[2] + ")");
		lightl_effect_animate.wave($light_effect_bg, select_rgb);
	}

	var postData = {"ledg_scheme": scheme_item_post.Mode};
	if(scheme_item_post.Mode == "1" || scheme_item_post.Mode == "2" || scheme_item_post.Mode == "3" || scheme_item_post.Mode == "7") {
		if(scheme_item_post.Mode != "1") {
			Object.keys(scheme_item_post["LED_Set"]).forEach(function(group_idx) {
				scheme_item_post["LED_Set"][group_idx]["R"] = select_rgb[0];
				scheme_item_post["LED_Set"][group_idx]["G"] = select_rgb[1];
				scheme_item_post["LED_Set"][group_idx]["B"] = select_rgb[2];
			});
		}
		var ledg_rgb_post = [];
		Object.keys(scheme_item_post["LED_Set"]).forEach(function(group_idx) {
			ledg_rgb_post.push(Math.ceil(scheme_item_post["LED_Set"][group_idx]["R"] / 2));
			ledg_rgb_post.push(Math.ceil(scheme_item_post["LED_Set"][group_idx]["G"] / 2));
			ledg_rgb_post.push(Math.ceil(scheme_item_post["LED_Set"][group_idx]["B"] / 2));
		});
		postData["ledg_rgb"] = ledg_rgb_post.join(',');
	}
	httpApi.set_ledg(postData);
}
function rgbToLeft(_rgb) {
	var hsl_array = color_converter.RGBtoHSL(_rgb);
	hsl.h = hsl_array[0];
	hsl.s = 100;
	hsl.l = 50;
	var left = Math.round((parseInt(hsl.h) / 360) * get_offset($hue_bar).width);
	$hue_slider.css("left", left);
	$hue_slider.css("background" , "hsl(" + hsl.h + ", " + hsl.s + "%" + ", " + hsl.l + "%" + ")");
	$light_effect_bg.css("background" , "hsl(" + hsl.h + ", " + hsl.s + "%" + ", " + hsl.l + "%" + ")");
}
var lightl_effect_animate = {
	"interval" : false,
	"breathing" : function(_obj, _rgbArr) {
		if(model_info.productid == "GT-AXE16000"){
			var breathing_color = function(_obj) {
				var led1 = "rgba(" + scheme_item_post['LED_Set'][1]['R'] + ", " + scheme_item_post['LED_Set'][1]['G'] + ", " + scheme_item_post['LED_Set'][1]['B'] + ", " + alpha + ") 40%";
				var led2 = "rgba(" + scheme_item_post['LED_Set'][2]['R'] + ", " + scheme_item_post['LED_Set'][2]['G'] + ", " + scheme_item_post['LED_Set'][2]['B'] + ", " + alpha + ") 60%";
				var led3 = "rgba(" + scheme_item_post['LED_Set'][3]['R'] + ", " + scheme_item_post['LED_Set'][3]['G'] + ", " + scheme_item_post['LED_Set'][3]['B'] + ", " + alpha + ") 80%";
				_obj.css("background", "linear-gradient(to right, " + led1 + ", " + led2 + ", " + led3 + ")");
			};
			breathing_color(_obj);
			var alpha = 1;
			var method = "decrease";
			lightl_effect_animate.interval = setInterval(function(){
				breathing_color(_obj);
				if(method == "decrease"){
					alpha = ((alpha*10)-(0.1*10))/10;
					if(alpha == 0.2)
						method = "increase";
				}
				else if(method == "increase"){
					alpha = ((alpha*10)+(0.1*10))/10;
					if(alpha == 1)
						method = "decrease";
				}
			},150);
		}
		else{
			var breathing_color = function(_obj, _rgbArr) {
				_obj.animate({
					backgroundColor: "rgba("+ _rgbArr[0] + ", " + _rgbArr[1] + ", " + _rgbArr[2] + ", 1)"
				}, 1000);

				_obj.animate({
					backgroundColor: "rgba("+ _rgbArr[0] + ", " + _rgbArr[1] + ", " + _rgbArr[2] + ", 0.2)"
				}, 1000);

			};
			breathing_color(_obj, _rgbArr);
			lightl_effect_animate.interval = setInterval(function(){
				breathing_color(_obj, _rgbArr);
			},2000);
		}
	},
	"marquee" : function(_obj, _rgbArr) {
		var percent_init = 0;
		var percent_end = 100;
		var marquee_color = function(_obj, _rgbArr) {
			var min = middle = max = 0;
			min = Math.max(0, (percent_init - 30));
			middle = percent_init;
			max = Math.min(100, (percent_init + 30));
			if(model_info.productid == "GT-AXE16000"){
				var led1 = "rgb(" + scheme_item_post['LED_Set'][1]['R'] + ", " + scheme_item_post['LED_Set'][1]['G'] + ", " + scheme_item_post['LED_Set'][1]['B'] + ") " + Math.max(0, (middle - 10)) + "%";
				var led2 = "rgb(" + scheme_item_post['LED_Set'][2]['R'] + ", " + scheme_item_post['LED_Set'][2]['G'] + ", " + scheme_item_post['LED_Set'][2]['B'] + ") " + middle + "%";
				var led3 = "rgb(" + scheme_item_post['LED_Set'][3]['R'] + ", " + scheme_item_post['LED_Set'][3]['G'] + ", " + scheme_item_post['LED_Set'][3]['B'] + ") " +  Math.min(100, (middle + 10)) + "%";
				_obj.css("background", "linear-gradient(to right, rgb(0, 0, 0) " + min + "%, " + led1 + ", " + led2 + ", " + led3 + ", rgb(0, 0, 0) " + max + "%)");
			}
			else{
				_obj.css("background", "linear-gradient(to right, rgb(0, 0, 0) " + min + "%, rgb("+ _rgbArr[0] + ", " + _rgbArr[1] + ", " + _rgbArr[2] + ") " + middle + "%, rgb(0, 0, 0) " + max + "%)");
			}
		};
		marquee_color(_obj, _rgbArr);
		lightl_effect_animate.interval = setInterval(function(){
			percent_init += 10;
			marquee_color(_obj, _rgbArr);
			if(percent_init >= 100)
				percent_init = 0;
		},200);
	},
	"wave" : function(_obj, _rgbArr) {
		var percent_init = 0;
		var percent_end = 100;
		var wave_color = function(_obj, _rgbArr) {
			if(model_info.productid == "GT-AXE16000"){
				var led1 = "rgb(" + scheme_item_post['LED_Set'][1]['R'] + ", " + scheme_item_post['LED_Set'][1]['G'] + ", " + scheme_item_post['LED_Set'][1]['B'] + ") " + Math.max(0, (percent_init - 10)) + "%";
				var led2 = "rgb(" + scheme_item_post['LED_Set'][2]['R'] + ", " + scheme_item_post['LED_Set'][2]['G'] + ", " + scheme_item_post['LED_Set'][2]['B'] + ") " + percent_init + "%";
				var led3 = "rgb(" + scheme_item_post['LED_Set'][3]['R'] + ", " + scheme_item_post['LED_Set'][3]['G'] + ", " + scheme_item_post['LED_Set'][3]['B'] + ") " +  Math.min(100, (percent_init + 10)) + "%";
				_obj.css("background", "linear-gradient(to right, rgb(0, 0, 0) 0%, " + led1 + ", " + led2 + ", " + led3 + ", rgb(0, 0, 0) 100%)");
			}
			else{
				_obj.css("background", "linear-gradient(to right, rgb(0, 0, 0) 0%, rgb("+ _rgbArr[0] + ", " + _rgbArr[1] + ", " + _rgbArr[2] + ") " + percent_init + "%, rgb(0, 0, 0) 100%)");
			}
		};
		wave_color(_obj, _rgbArr);
		lightl_effect_animate.interval = setInterval(function(){
			percent_init += 10;
			wave_color(_obj, _rgbArr);
			if(percent_init >= 100)
				percent_init = 0;
		},150);
	},
	"clear" : function(_obj) {
		clearInterval(lightl_effect_animate.interval);
		_obj.stop(true,true);
	}
}
function control_scheme_list(_idx) {
	var start_idx = ((_idx -1 ) * scheme_page_max_count);
	$("#light_effect_setting .setting_scheme .scheme_bg").hide();
	for(var i = ((_idx -1 ) * scheme_page_max_count); i < ((_idx -1 ) * scheme_page_max_count) + scheme_page_max_count ; i += 1) {
		$("#light_effect_setting .setting_scheme .scheme_bg").eq(i).show();
	}
	$("#light_effect_setting .scheme_list_bg .boundary").addClass("arrow");
	if(_idx == 1)
		$("#light_effect_setting .scheme_list_bg #boundary_left").removeClass("arrow");
	if(_idx == scheme_pages)
		$("#light_effect_setting .scheme_list_bg #boundary_right").removeClass("arrow");
}
function multiply_rgb(_value) {
	return (Math.ceil(_value * 2) > 255) ? 255 : Math.ceil(_value * 2);
}
function isSupport(_ptn){
	var ui_support = [<% get_ui_support(); %>][0];
	return (ui_support[_ptn]) ? ui_support[_ptn] : 0;
}
function gradient_transform_left(_left){
	var screen_width = $hue_bar.outerWidth(true);
	return parseInt((screen_width / 320) * _left);
}
function switch_mode(_type){
	$("div[mode_group]").hide();
	$("div[mode_group=" + _type + "]").show();
}
$(document).ready(initial_led_control);
</script>
<body style="margin:initial;">
<div class="light_effect_bg" id="light_effect_bg" mode_group="panel">
	<div class="logo_container logo_aura_rgb"></div>
	<div class="switch_mode_list_bg">
		<div class="mode_list_bg">
			<div class="panel active" mode="panel"></div>
			<div class="antenna" mode="antenna"></div>
		</div>
	</div>
	<div class="light_effect_mask"></div>
</div>
<div class="light_effect_setting_bg" id="light_effect_setting" mode_group="panel">
	<div class="setting_enable_bg">
		<div class="text"><span>Aura RGB <#WLANConfig11b_WirelessCtrl_button1name#></span></div>
		<div class="switch"></div>
		<div class="schedule"></div>
	</div>
	<div class="switch_off">
		<div class="horizontal_line "></div>
		<div class="scheme_list_bg">
			<div id="boundary_left" class="boundary arrow"></div>
			<div class="setting_scheme support_hover">
				<div id="static" class="scheme_bg" mode="2">
					<div class="icon"></div>
					<div class="text"><#BoostKey_AURA_state_static#></div>
				</div>
				<div id="breathing" class="scheme_bg" mode="3">
					<div class="icon"></div>
					<div class="text"><#BoostKey_AURA_state_breathing#></div>
				</div>
				<div id="wave" class="scheme_bg" mode="6">
					<div class="icon"></div>
					<div class="text"><#BoostKey_AURA_state_wave#></div>
				</div>
				<div id="marquee" class="scheme_bg" mode="7">
					<div class="icon"></div>
					<div class="text"><#AURA_Scheme_Marquee#></div>
				</div>
				<div id="gradient" class="scheme_bg" mode="1">
					<div class="icon"></div>
					<div class="text"><#AURA_Scheme_Gradient#></div>
				</div>
				<div id="evolution" class="scheme_bg" mode="4">
					<div class="icon"></div>
					<div class="text"><#AURA_Scheme_Evolution#></div>
				</div>
				<div id="rainbow" class="scheme_bg"mode="5">
					<div class="icon"></div>
					<div class="text"><#BoostKey_AURA_state_rainbow#></div>
				</div>
				<div class="scheme_bg empty"></div>
			</div>
			<div id="boundary_right" class="boundary arrow"></div>
		</div>
		<div class="horizontal_line"></div>
		<div class="setting_hue">
			<div class="hue_bar" id="hue_bar">
				<div class="hue_slider" id="hue_slider"></div>
			</div>
			<div class="hue_bar_mask"></div>
			<div id="default_set"><#Setting_factorydefault_value#></div>
		</div>
	</div>
	<div class="all_led_off">Please enable the LED function by pressing the middle hardware button on the front cover about 3 seconds.</div><!-- untranslated -->
</div>

<div class="light_effect_bg" id="antenna_bg" mode_group="antenna">
	<div class="logo_container logo_antenna"></div>
	<div class="switch_mode_list_bg">
		<div class="mode_list_bg">
			<div class="panel" mode="panel"></div>
			<div class="antenna active" mode="antenna"></div>
		</div>
	</div>
	<div class="light_effect_mask"></div>
</div>
<div class="light_effect_setting_bg" id="antenna_setting" mode_group="antenna">
	<div class="setting_enable_bg">
		<div class="text"><span>Antenna Scheme</span></div>
		<div class="switch" style="display: none;"></div>
	</div>
	<div class="switch_off">
		<div class="horizontal_line "></div>
		<div class="scheme_list_bg">
			<div id="boundary_left" class="boundary"></div>
			<div class="setting_scheme antenna support_hover">
				<div id="static" class="scheme_bg" mode="1">
					<div class="icon"></div>
					<div class="text"><#BoostKey_AURA_state_static#></div>
				</div>
				<div id="interaction" class="scheme_bg" mode="2">
					<div class="icon"></div>
					<div class="text"><#Interaction#></div>
				</div>
			</div>
			<div id="boundary_right" class="boundary"></div>
		</div>
	</div>
</div>
</body>
